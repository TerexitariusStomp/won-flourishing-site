import{aA as zn,aB as Ir,aC as Ft,aD as Ee,aE as Mr,aF as vr,aG as Je,aH as Ae,aI as kr,aJ as Pn,aK as Xe,aL as L,aM as ut,aN as G,aO as fe,ax as jr,aP as V,aQ as Er,aR as xe,aS as Ar,aT as N,aU as dt,aV as xr,aW as Dr,aX as Tr,aY as lt,aZ as Yt,a_ as Nn,a$ as At,b0 as Jt,b1 as Xt,b2 as Or,W as Z,O as en,b3 as Cr,R as zr,S as Pr,U as gt,V as Nr,P as ue,C as Sr,D as _r,I as qr,n as et,o as xt,B as ve,q as Rr,T as Ur,p as Kr,b4 as Lr,b5 as Bt,b6 as Le,b7 as $r,b8 as Fr,b9 as Ve,ba as Sn,bb as P,bc as Wt,bd as _n,be as qn,bf as Yr,bg as De,bh as Br,Z as Wr,Y as Qr,bi as Hr,d as Vr,bj as Zr,bk as Gr,bl as z,bm as tn,bn as q,bo as Rn,bp as ft,bq as Jr,br as Xr,bs as nn,bt as ke,bu as rn,bv as es,bw as sn,bx as an,by as on,bz as ts,bA as ns,bB as cn,bC as rs,bD as ss,bE as un,bF as dn,bG as as,bH as os,bI as is,bJ as pt,av as Un,bK as cs,bL as us,bM as ds,bN as ls,bO as fs,bP as ps,bQ as hs,bR as ys,bS as ms,bT as gs,bU as ws,bV as Qt,bW as bs,bX as Kn,bY as Ln,bZ as Is,b_ as Ms,b$ as vs,c0 as ks,c1 as js,c2 as Es,c3 as As,c4 as xs,c5 as Ht,c6 as Ds,c7 as Ts,c8 as tt,c9 as nt,ca as Os,cb as Cs,cc as zs,cd as Ps,ce as Ns,cf as Ss,cg as _s,ch as qs,ci as Rs,cj as Us,ck as Ie,cl as Ks}from"./index-CGjvahgo.js";import{s as Vt,p as rt,c as Ls,d as $s,a as Fs,b as Ys}from"./vanilla-ClYN0NLm.js";import{s as Bs,a as Ws,t as Qs,c as Hs,b as Vs,d as Dt,e as Zs,f as Gs,o as Js,g as Xs,p as ea,h as ta}from"./sepolia-DDSGXsHJ.js";import{c as na,s as ra,d as sa,g as aa}from"./index-nibyPLVP.js";function ht(t,e={}){return Ir(t,e)}function oa(t,e,n){if(e==="Error")return ln;if(e==="Panic")return fn;if(Ft(e,{strict:!1})){const s=Ee(e,0,4);if(s===ca)return ln;if(s===ua)return fn}const r=Mr(t,e,n);if(r.type!=="error")throw new vr({name:e,type:"error"});return r}function ia(t){return zn(t)}const ln=ht({inputs:[{name:"message",type:"string"}],name:"Error",type:"error"}),ca="0x08c379a0",fn=ht({inputs:[{name:"reason",type:"uint8"}],name:"Panic",type:"error"}),ua="0x4e487b71",da=new TextEncoder,la=new TextDecoder,$e=Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((t,e)=>[e,t.charCodeAt(0)])),Fe={...Object.fromEntries(Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map((t,e)=>[t.charCodeAt(0),e])),61:0,45:62,95:63};function fa(t,e={}){const{pad:n=!0,url:r=!1}=e,s=new Uint8Array(Math.ceil(t.length/3)*4);for(let i=0,a=0;a<t.length;i+=4,a+=3){const c=(t[a]<<16)+(t[a+1]<<8)+(t[a+2]|0);s[i]=$e[c>>18],s[i+1]=$e[c>>12&63],s[i+2]=$e[c>>6&63],s[i+3]=$e[c&63]}const o=t.length%3,u=Math.floor(t.length/3)*4+(o&&o+1);let f=la.decode(new Uint8Array(s.buffer,0,u));return n&&o===1&&(f+="=="),n&&o===2&&(f+="="),r&&(f=f.replaceAll("+","-").replaceAll("/","_")),f}function pa(t,e={}){return fa(Je(t),e)}function Tt(t){const e=t.replace(/=+$/,""),n=e.length,r=new Uint8Array(n+3);da.encodeInto(e+"===",r);for(let o=0,u=0;o<e.length;o+=4,u+=3){const f=(Fe[r[o]]<<18)+(Fe[r[o+1]]<<12)+(Fe[r[o+2]]<<6)+Fe[r[o+3]];r[u]=f>>16,r[u+1]=f>>8&255,r[u+2]=f&255}const s=(n>>2)*3+(n%4&&n%4-1);return new Uint8Array(r.buffer,0,s)}function $n(t){const{privateKey:e}=t,n=Vt.ProjectivePoint.fromPrivateKey(typeof e=="string"?e.slice(2):Ae(e).slice(2));return Xe(n)}function Fn(t={}){const{as:e="Hex"}=t,n=Vt.utils.randomPrivateKey();return e==="Hex"?Ae(n):n}function pn(t){const{extraEntropy:e=kr,hash:n,payload:r,privateKey:s}=t,{r:o,s:u,recovery:f}=Vt.sign(r instanceof Uint8Array?r:Je(r),s instanceof Uint8Array?s:Je(s),{extraEntropy:typeof e=="boolean"?e:Pn(e).slice(2),lowS:!0,...n?{prehash:!0}:{}});return{r:o,s:u,yParity:f}}function ha(t){const e=Pn(t);return ut("0x19",G(`Ethereum Signed Message:
`+fe(e)),e)}function Ye(t){return L(ha(t))}var wt={exports:{}},hn;function ya(){return hn||(hn=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(i,a,c){this.fn=i,this.context=a,this.once=c||!1}function o(i,a,c,d,p){if(typeof c!="function")throw new TypeError("The listener must be a function");var l=new s(c,d||i,p),h=n?n+a:a;return i._events[h]?i._events[h].fn?i._events[h]=[i._events[h],l]:i._events[h].push(l):(i._events[h]=l,i._eventsCount++),i}function u(i,a){--i._eventsCount===0?i._events=new r:delete i._events[a]}function f(){this._events=new r,this._eventsCount=0}f.prototype.eventNames=function(){var a=[],c,d;if(this._eventsCount===0)return a;for(d in c=this._events)e.call(c,d)&&a.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(c)):a},f.prototype.listeners=function(a){var c=n?n+a:a,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,l=d.length,h=new Array(l);p<l;p++)h[p]=d[p].fn;return h},f.prototype.listenerCount=function(a){var c=n?n+a:a,d=this._events[c];return d?d.fn?1:d.length:0},f.prototype.emit=function(a,c,d,p,l,h){var m=n?n+a:a;if(!this._events[m])return!1;var y=this._events[m],g=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(a,y.fn,void 0,!0),g){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,d),!0;case 4:return y.fn.call(y.context,c,d,p),!0;case 5:return y.fn.call(y.context,c,d,p,l),!0;case 6:return y.fn.call(y.context,c,d,p,l,h),!0}for(w=1,b=new Array(g-1);w<g;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var I=y.length,M;for(w=0;w<I;w++)switch(y[w].once&&this.removeListener(a,y[w].fn,void 0,!0),g){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,c);break;case 3:y[w].fn.call(y[w].context,c,d);break;case 4:y[w].fn.call(y[w].context,c,d,p);break;default:if(!b)for(M=1,b=new Array(g-1);M<g;M++)b[M-1]=arguments[M];y[w].fn.apply(y[w].context,b)}}return!0},f.prototype.on=function(a,c,d){return o(this,a,c,d,!1)},f.prototype.once=function(a,c,d){return o(this,a,c,d,!0)},f.prototype.removeListener=function(a,c,d,p){var l=n?n+a:a;if(!this._events[l])return this;if(!c)return u(this,l),this;var h=this._events[l];if(h.fn)h.fn===c&&(!p||h.once)&&(!d||h.context===d)&&u(this,l);else{for(var m=0,y=[],g=h.length;m<g;m++)(h[m].fn!==c||p&&!h[m].once||d&&h[m].context!==d)&&y.push(h[m]);y.length?this._events[l]=y.length===1?y[0]:y:u(this,l)}return this},f.prototype.removeAllListeners=function(a){var c;return a?(c=n?n+a:a,this._events[c]&&u(this,c)):(this._events=new r,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=n,f.EventEmitter=f,t.exports=f})(wt)),wt.exports}var ma=ya();const ga=jr(ma);function wa(t,e={}){const{raw:n=!1}=e,r=t;if(n)return t;if(r.error)throw Yn(r.error);return r.result}function Yn(t){const e=t;if(e instanceof Error&&!("code"in e))return new te({cause:e,data:e,message:e.message,stack:e.stack});const{code:n}=e;return n===te.code?new te(e):n===Te.code?new Te(e):n===ce.code?new ce(e):n===Ne.code?new Ne(e):n===ze.code?new ze(e):n===Se.code?new Se(e):n===ie.code?new ie(e):n===_e.code?new _e(e):n===Oe.code?new Oe(e):n===Ce.code?new Ce(e):n===oe.code?new oe(e):n===Pe.code?new Pe(e):new te({cause:e instanceof Error?e:void 0,data:e,message:e.message,stack:e instanceof Error?e.stack:void 0})}class B extends Error{constructor(e){const{cause:n,code:r,message:s,data:o,stack:u}=e;super(s,{cause:n}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.BaseError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=n,this.code=r,this.data=o,this.stack=u??""}}class Te extends B{constructor(e={}){super({code:Te.code,data:e.data,message:e.message??"Missing or invalid parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidInputError"})}}Object.defineProperty(Te,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Oe extends B{constructor(e={}){super({code:Oe.code,data:e.data,message:e.message??"Requested resource not found."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceNotFoundError"})}}Object.defineProperty(Oe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Ce extends B{constructor(e={}){super({code:Ce.code,data:e.data,message:e.message??"Requested resource not available."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ResourceUnavailableError"})}}Object.defineProperty(Ce,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class oe extends B{constructor(e={}){super({code:oe.code,data:e.data,message:e.message??"Transaction creation failed."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.TransactionRejectedError"})}}Object.defineProperty(oe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class ie extends B{constructor(e={}){super({code:ie.code,data:e.data,message:e.message??"Method is not implemented."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotSupportedError"})}}Object.defineProperty(ie,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class ze extends B{constructor(e={}){super({code:ze.code,data:e.data,message:e.message??"Rate limit exceeded."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.LimitExceededError"})}}Object.defineProperty(ze,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Pe extends B{constructor(e={}){super({code:Pe.code,data:e.data,message:e.message??"JSON-RPC version not supported."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.VersionNotSupportedError"})}}Object.defineProperty(Pe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Ne extends B{constructor(e={}){super({code:Ne.code,data:e.data,message:e.message??"Input is not a valid JSON-RPC request."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidRequestError"})}}Object.defineProperty(Ne,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Se extends B{constructor(e={}){super({code:Se.code,data:e.data,message:e.message??"Method does not exist."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.MethodNotFoundError"})}}Object.defineProperty(Se,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class ce extends B{constructor(e={}){super({code:ce.code,data:e.data,message:e.message??"Invalid method parameters."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InvalidParamsError"})}}Object.defineProperty(ce,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class te extends B{constructor(e={}){super({cause:e.cause,code:te.code,data:e.data,message:e.message??"Internal JSON-RPC error.",stack:e.stack}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.InternalError"})}}Object.defineProperty(te,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class _e extends B{constructor(e={}){super({code:_e.code,data:e.data,message:e.message??"Failed to parse JSON-RPC response."}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RpcResponse.ParseError"})}}Object.defineProperty(_e,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class F extends Error{constructor(e,n){super(n),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderRpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=e,this.details=n}}class pe extends F{constructor({message:e="The user rejected the request."}={}){super(4001,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UserRejectedRequestError"})}}Object.defineProperty(pe,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class S extends F{constructor({message:e="The requested method and/or account has not been authorized by the user."}={}){super(4100,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnauthorizedError"})}}Object.defineProperty(S,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class qe extends F{constructor({message:e="The provider does not support the requested method."}={}){super(4200,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedMethodError"})}}Object.defineProperty(qe,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class _ extends F{constructor({message:e="The provider is disconnected from all chains."}={}){super(4900,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DisconnectedError"})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ee extends F{constructor({message:e="The provider is not connected to the requested chain."}={}){super(4901,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.ChainDisconnectedError"})}}Object.defineProperty(ee,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Ot extends F{constructor({message:e="An error occurred when attempting to switch chain."}={}){super(4902,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.SwitchChainError"})}}Object.defineProperty(Ot,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Ct extends F{constructor({message:e="This Wallet does not support a capability that was not marked as optional."}={}){super(5700,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedNonOptionalCapabilityError"})}}Object.defineProperty(Ct,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class st extends F{constructor({message:e="This Wallet does not support the requested chain ID."}={}){super(5710,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnsupportedChainIdError"})}}Object.defineProperty(st,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class zt extends F{constructor({message:e="There is already a bundle submitted with this ID."}={}){super(5720,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.DuplicateIdError"})}}Object.defineProperty(zt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Re extends F{constructor({message:e="This bundle id is unknown / has not been submitted."}={}){super(5730,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.UnknownBundleIdError"})}}Object.defineProperty(Re,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Pt extends F{constructor({message:e="The call bundle is too large for the Wallet to process."}={}){super(5740,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.BundleTooLargeError"})}}Object.defineProperty(Pt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Nt extends F{constructor({message:e="The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."}={}){super(5750,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicReadyWalletRejectedUpgradeError"})}}Object.defineProperty(Nt,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class St extends F{constructor({message:e="The wallet does not support atomic execution but the request requires it."}={}){super(5760,e),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.AtomicityNotSupportedError"})}}Object.defineProperty(St,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});function ba(){const t=new ga;return{get eventNames(){return t.eventNames.bind(t)},get listenerCount(){return t.listenerCount.bind(t)},get listeners(){return t.listeners.bind(t)},addListener:t.addListener.bind(t),emit:t.emit.bind(t),off:t.off.bind(t),on:t.on.bind(t),once:t.once.bind(t),removeAllListeners:t.removeAllListeners.bind(t),removeListener:t.removeListener.bind(t)}}function Bn(t,e={}){const{includeEvents:n=!0}=e;if(!t)throw new Ia;return{...n?{on:t.on?.bind(t),removeListener:t.removeListener?.bind(t)}:{},async request(r){try{const s=await t.request(r);return s&&typeof s=="object"&&"jsonrpc"in s?wa(s):s}catch(s){throw Wn(s)}}}}function Wn(t){const e=Yn(t);if(e instanceof te){if(!e.data)return e;const{code:n}=e.data;if(n===_.code)return new _(e);if(n===ee.code)return new ee(e);if(n===pe.code)return new pe(e);if(n===S.code)return new S(e);if(n===qe.code)return new qe(e);if(n===Ot.code)return new Ot(e);if(n===Nt.code)return new Nt(e);if(n===St.code)return new St(e);if(n===Pt.code)return new Pt(e);if(n===Re.code)return new Re(e);if(n===zt.code)return new zt(e);if(n===st.code)return new st(e);if(n===Ct.code)return new Ct(e)}return e}class Ia extends V{constructor(){super("`provider` is undefined."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Provider.IsUndefinedError"})}}function Ma(t={}){let e=t.id??0;return{prepare(n){return va({id:e++,...n})},get id(){return e}}}function va(t){return{...t,jsonrpc:"2.0"}}const ka=/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(:[0-9]{1,5})?$/,ja=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:[0-9]{1,5})?$/,Ea=/^localhost(:[0-9]{1,5})?$/,Aa=/^[a-zA-Z0-9]{8,}$/,xa=/^([a-zA-Z][a-zA-Z0-9+-.]*)$/,Da=/^(?:(?<scheme>[a-zA-Z][a-zA-Z0-9+-.]*):\/\/)?(?<domain>[a-zA-Z0-9+-.]*(?::[0-9]{1,5})?) (?:wants you to sign in with your Ethereum account:\n)(?<address>0x[a-fA-F0-9]{40})\n\n(?:(?<statement>.*)\n\n)?/,Ta=/(?:URI: (?<uri>.+))\n(?:Version: (?<version>.+))\n(?:Chain ID: (?<chainId>\d+))\n(?:Nonce: (?<nonce>[a-zA-Z0-9]+))\n(?:Issued At: (?<issuedAt>.+))(?:\nExpiration Time: (?<expirationTime>.+))?(?:\nNot Before: (?<notBefore>.+))?(?:\nRequest ID: (?<requestId>.+))?/;function Oa(t){const{chainId:e,domain:n,expirationTime:r,issuedAt:s=new Date,nonce:o,notBefore:u,requestId:f,resources:i,scheme:a,uri:c,version:d}=t;{if(e!==Math.floor(e))throw new J({field:"chainId",metaMessages:["- Chain ID must be a EIP-155 chain ID.","- See https://eips.ethereum.org/EIPS/eip-155","",`Provided value: ${e}`]});if(!(ka.test(n)||ja.test(n)||Ea.test(n)))throw new J({field:"domain",metaMessages:["- Domain must be an RFC 3986 authority.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${n}`]});if(!Aa.test(o))throw new J({field:"nonce",metaMessages:["- Nonce must be at least 8 characters.","- Nonce must be alphanumeric.","",`Provided value: ${o}`]});if(!yn(c))throw new J({field:"uri",metaMessages:["- URI must be a RFC 3986 URI referring to the resource that is the subject of the signing.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${c}`]});if(d!=="1")throw new J({field:"version",metaMessages:["- Version must be '1'.","",`Provided value: ${d}`]});if(a&&!xa.test(a))throw new J({field:"scheme",metaMessages:["- Scheme must be an RFC 3986 URI scheme.","- See https://www.rfc-editor.org/rfc/rfc3986#section-3.1","",`Provided value: ${a}`]});const g=t.statement;if(g?.includes(`
`))throw new J({field:"statement",metaMessages:["- Statement must not include '\\n'.","",`Provided value: ${g}`]})}const p=Er(t.address,{checksum:!0}),l=a?`${a}://${n}`:n,h=t.statement?`${t.statement}
`:"",m=`${l} wants you to sign in with your Ethereum account:
${p}

${h}`;let y=`URI: ${c}
Version: ${d}
Chain ID: ${e}
Nonce: ${o}
Issued At: ${s.toISOString()}`;if(r&&(y+=`
Expiration Time: ${r.toISOString()}`),u&&(y+=`
Not Before: ${u.toISOString()}`),f&&(y+=`
Request ID: ${f}`),i){let g=`
Resources:`;for(const b of i){if(!yn(b))throw new J({field:"resources",metaMessages:["- Every resource must be a RFC 3986 URI.","- See https://www.rfc-editor.org/rfc/rfc3986","",`Provided value: ${b}`]});g+=`
- ${b}`}y+=g}return`${m}
${y}`}function yn(t){if(/[^a-z0-9:/?#[\]@!$&'()*+,;=.\-_~%]/i.test(t)||/%[^0-9a-f]/i.test(t)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(t))return!1;const e=Ca(t),n=e[1],r=e[2],s=e[3],o=e[4],u=e[5];if(!(n?.length&&s&&s.length>=0))return!1;if(r?.length){if(!(s.length===0||/^\//.test(s)))return!1}else if(/^\/\//.test(s))return!1;if(!/^[a-z][a-z0-9+\-.]*$/.test(n.toLowerCase()))return!1;let f="";return f+=`${n}:`,r?.length&&(f+=`//${r}`),f+=s,o?.length&&(f+=`?${o}`),u?.length&&(f+=`#${u}`),f}function Ca(t){return t.match(/(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)}function za(t){const{scheme:e,statement:n,...r}=t.match(Da)?.groups??{},{chainId:s,expirationTime:o,issuedAt:u,notBefore:f,requestId:i,...a}=t.match(Ta)?.groups??{},c=t.split("Resources:")[1]?.split(`
- `).slice(1);return{...r,...a,...s?{chainId:Number(s)}:{},...o?{expirationTime:new Date(o)}:{},...u?{issuedAt:new Date(u)}:{},...f?{notBefore:new Date(f)}:{},...i?{requestId:i}:{},...c?{resources:c}:{},...e?{scheme:e}:{},...n?{statement:n}:{}}}class J extends V{constructor(e){const{field:n,metaMessages:r}=e;super(`Invalid Sign-In with Ethereum message field "${n}".`,{metaMessages:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Siwe.InvalidMessageFieldError"})}}function Qn(t,e=0){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new Pa({value:t});let[n="",r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[o,u,f]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],i=Math.round(+`${u}.${f}`);i>9?r=`${BigInt(o)+BigInt(1)}0`.padStart(o.length+1,"0"):r=`${o}${i}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}class Pa extends V{constructor({value:e}){super(`Value \`${e}\` is not a valid decimal number.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Value.InvalidDecimalNumberError"})}}function Na(t){const{domain:e,message:n,primaryType:r,types:s}=t,o=(u,f)=>{for(const i of u){const{name:a,type:c}=i,d=f[a],p=c.match(Ar);if(p&&(typeof d=="number"||typeof d=="bigint")){const[,m,y]=p;N(d,{signed:m==="int",size:Number.parseInt(y??"",10)/8})}if(c==="address"&&typeof d=="string"&&!dt(d))throw new xr({address:d,cause:new Dr});const l=c.match(Tr);if(l){const[,m]=l;if(m&&fe(d)!==Number.parseInt(m,10))throw new Ra({expectedSize:Number.parseInt(m,10),givenSize:fe(d)})}const h=s[c];h&&(Fa(c),o(h,d))}};if(s.EIP712Domain&&e){if(typeof e!="object")throw new Ua({domain:e});o(s.EIP712Domain,e)}if(r!=="EIP712Domain")if(s[r])o(s[r],n);else throw new Ka({primaryType:r,types:s})}function Sa(t){const{domain:e={},message:n,primaryType:r}=t,s={EIP712Domain:Hn(e),...t.types};Na({domain:e,message:n,primaryType:r,types:s});const o=["0x19","0x01"];return e&&o.push(qa({domain:e,types:s})),r!=="EIP712Domain"&&o.push(Vn({data:n,primaryType:r,types:s})),ut(...o)}function _a(t){const{primaryType:e,types:n}=t;let r="";const s=Jn({primaryType:e,types:n});s.delete(e);const o=[e,...Array.from(s).sort()];for(const u of o)r+=`${u}(${(n[u]??[]).map(({name:f,type:i})=>`${i} ${f}`).join(",")})`;return r}function Hn(t){return[typeof t?.name=="string"&&{name:"name",type:"string"},t?.version&&{name:"version",type:"string"},(typeof t?.chainId=="number"||typeof t?.chainId=="bigint")&&{name:"chainId",type:"uint256"},t?.verifyingContract&&{name:"verifyingContract",type:"address"},t?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function Zt(t){return L(Sa(t))}function qa(t){const{domain:e,types:n}=t;return Vn({data:e,primaryType:"EIP712Domain",types:{...n,EIP712Domain:n?.EIP712Domain||Hn(e)}})}function Vn(t){const{data:e,primaryType:n,types:r}=t,s=Zn({data:e,primaryType:n,types:r});return L(s)}class Ra extends V{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.BytesSizeMismatchError"})}}class Ua extends V{constructor({domain:e}){super(`Invalid domain "${xe(e)}".`,{metaMessages:["Must be a valid EIP-712 domain."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidDomainError"})}}class Ka extends V{constructor({primaryType:e,types:n}){super(`Invalid primary type \`${e}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{metaMessages:["Check that the primary type is a key in `types`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidPrimaryTypeError"})}}class La extends V{constructor({type:e}){super(`Struct type "${e}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidStructTypeError"})}}function Zn(t){const{data:e,primaryType:n,types:r}=t,s=[{type:"bytes32"}],o=[$a({primaryType:n,types:r})];for(const u of r[n]??[]){const[f,i]=Gn({types:r,name:u.name,type:u.type,value:e[u.name]});s.push(f),o.push(i)}return lt(s,o)}function $a(t){const{primaryType:e,types:n}=t,r=G(_a({primaryType:e,types:n}));return L(r)}function Gn(t){let{types:e,name:n,type:r,value:s}=t;if(e[r]!==void 0)return[{type:"bytes32"},L(Zn({data:s,primaryType:r,types:e}))];if(r==="bytes")return s=`0x${(s.length%2?"0":"")+s.slice(2)}`,[{type:"bytes32"},L(s,{as:"Hex"})];if(r==="string")return[{type:"bytes32"},L(Yt(s),{as:"Hex"})];if(r.lastIndexOf("]")===r.length-1){const o=r.slice(0,r.lastIndexOf("[")),u=s.map(f=>Gn({name:n,type:o,types:e,value:f}));return[{type:"bytes32"},L(lt(u.map(([f])=>f),u.map(([,f])=>f)))]}return[{type:r},s]}function Jn(t,e=new Set){const{primaryType:n,types:r}=t,o=n.match(/^\w*/u)?.[0];if(e.has(o)||r[o]===void 0)return e;e.add(o);for(const u of r[o])Jn({primaryType:u.type,types:r},e);return e}function Fa(t){if(t==="address"||t==="bool"||t==="string"||t.startsWith("bytes")||t.startsWith("uint")||t.startsWith("int"))throw new La({type:t})}function Ya(t){const e=t[4]===0?5:4,n=e+32,r=t[n+2]===0?n+3:n+2,s=BigInt(Ae(t.slice(e,n))),o=BigInt(Ae(t.slice(r)));return{r:s,s:o>rt.CURVE.n/2n?rt.CURVE.n-o:o}}async function Ba(t){try{const e=t.getPublicKey();if(!e)throw new at;const n=new Uint8Array(e),r=await crypto.subtle.importKey("spki",new Uint8Array(n),{name:"ECDSA",namedCurve:"P-256",hash:"SHA-256"},!0,["verify"]),s=new Uint8Array(await crypto.subtle.exportKey("raw",r));return Xe(s)}catch(e){if(e.message!=="Permission denied to access object")throw e;const n=new Uint8Array(t.attestationObject),r=32,s=88,o=i=>{const a=new Uint8Array([i,s,r]);for(let c=0;c<n.length-a.length;c++)if(a.every((d,p)=>n[c+p]===d))return c+a.length;throw new at},u=o(33),f=o(34);return Xe(new Uint8Array([4,...n.slice(u,u+r),...n.slice(f,f+r)]))}}const Wa=Uint8Array.from([105,171,180,181,160,222,75,198,42,42,32,31,141,37,186,233]);async function Qa(t){const{createFn:e=window.navigator.credentials.create.bind(window.navigator.credentials),...n}=t,r=Za(n);try{const s=await e(r);if(!s)throw new at;const o=s.response,u=await Ba(o);return{id:s.id,publicKey:u,raw:s}}catch(s){throw new at({cause:s})}}function Ha(t={}){const{flag:e=5,rpId:n=window.location.hostname,signCount:r=0}=t,s=Nn(G(n)),o=N(e,{size:1}),u=N(r,{size:4});return ut(s,o,u)}function Va(t){const{challenge:e,crossOrigin:n=!1,extraClientData:r,origin:s=window.location.origin}=t;return JSON.stringify({type:"webauthn.get",challenge:pa(e,{url:!0,pad:!1}),origin:s,crossOrigin:n,...r})}function Za(t){const{attestation:e="none",authenticatorSelection:n={residentKey:"preferred",requireResidentKey:!1,userVerification:"required"},challenge:r=Wa,excludeCredentialIds:s,extensions:o,name:u,rp:f={id:window.location.hostname,name:window.document.title},user:i}=t,a=i?.name??u;return{publicKey:{attestation:e,authenticatorSelection:n,challenge:r,...s?{excludeCredentials:s?.map(c=>({id:Tt(c),type:"public-key"}))}:{},pubKeyCredParams:[{type:"public-key",alg:-7}],...o&&{extensions:o},rp:f,user:{id:i?.id??L(Yt(a),{as:"Bytes"}),name:a,displayName:i?.displayName??a}}}}function Ga(t){const{credentialId:e,challenge:n,extensions:r,rpId:s=window.location.hostname,userVerification:o="required"}=t;return{publicKey:{...e?{allowCredentials:Array.isArray(e)?e.map(u=>({id:Tt(u),type:"public-key"})):[{id:Tt(e),type:"public-key"}]}:{},challenge:Je(n),...r&&{extensions:r},rpId:s,userVerification:o}}}function Ja(t){const{challenge:e,crossOrigin:n,extraClientData:r,flag:s,origin:o,rpId:u,signCount:f,userVerification:i="required"}=t,a=Ha({flag:s,rpId:u,signCount:f}),c=Va({challenge:e,crossOrigin:n,extraClientData:r,origin:o}),d=Nn(G(c)),p=c.indexOf('"challenge"'),l=c.indexOf('"type"'),h={authenticatorData:a,clientDataJSON:c,challengeIndex:p,typeIndex:l,userVerificationRequired:i==="required"},m=ut(a,d);return{metadata:h,payload:m}}async function Xn(t){const{getFn:e=window.navigator.credentials.get.bind(window.navigator.credentials),...n}=t,r=Ga(n);try{const s=await e(r);if(!s)throw new mn;const o=s.response,u=String.fromCharCode(...new Uint8Array(o.clientDataJSON)),f=u.indexOf('"challenge"'),i=u.indexOf('"type"'),a=Ya(new Uint8Array(o.signature));return{metadata:{authenticatorData:Ae(new Uint8Array(o.authenticatorData)),clientDataJSON:u,challengeIndex:f,typeIndex:i,userVerificationRequired:r.publicKey.userVerification==="required"},signature:a,raw:s}}catch(s){throw new mn({cause:s})}}class at extends V{constructor({cause:e}={}){super("Failed to create credential.",{cause:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialCreationFailedError"})}}class mn extends V{constructor({cause:e}={}){super("Failed to request credential.",{cause:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WebAuthnP256.CredentialRequestFailedError"})}}async function Xa(t={}){const{extractable:e=!1}=t,n=await globalThis.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},e,["sign","verify"]),r=await globalThis.crypto.subtle.exportKey("raw",n.publicKey),s=Xe(new Uint8Array(r));return{privateKey:n.privateKey,publicKey:s}}async function eo(t){const{payload:e,privateKey:n}=t,r=await globalThis.crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},n,At(e)),s=Or(new Uint8Array(r)),o=Jt(Xt(s,0,32));let u=Jt(Xt(s,32,64));return u>rt.CURVE.n/2n&&(u=rt.CURVE.n-u),{r:o,s:u}}const to=Z({id:31337,name:"Anvil",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},rpcUrls:{default:{http:["http://127.0.0.1:8545"],webSocket:["ws://127.0.0.1:8545"]}}}),no=Z({id:421614,name:"Arbitrum Sepolia",blockTime:250,nativeCurrency:{name:"Arbitrum Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia-rollup.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://sepolia.arbiscan.io",apiUrl:"https://api-sepolia.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:81930}},testnet:!0}),ro=Z({id:80094,name:"Berachain",blockTime:2e3,nativeCurrency:{decimals:18,name:"BERA Token",symbol:"BERA"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0},ensRegistry:{address:"0x5b22280886a2f5e09a49bea7e320eab0e5320e28",blockCreated:877007},ensUniversalResolver:{address:"0x4D41762915F83c76EcaF6776d9b08076aA32b492",blockCreated:9310021}},rpcUrls:{default:{http:["https://rpc.berachain.com"]}},blockExplorers:{default:{name:"Berascan",url:"https://berascan.com"}},ensTlds:[".bera"],testnet:!1}),so=Z({id:80069,blockTime:2e3,name:"Berachain Bepolia",nativeCurrency:{decimals:18,name:"BERA Token",symbol:"BERA"},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:0}},rpcUrls:{default:{http:["https://bepolia.rpc.berachain.com"]}},blockExplorers:{default:{name:"Berascan",url:"https://bepolia.beratrail.io"}},testnet:!0}),ao={estimateFeesPerGas:async t=>{if(!t.request?.feeCurrency)return null;const[e,n]=await Promise.all([oo(t.client,t.request.feeCurrency),io(t.client,t.request.feeCurrency)]);return{maxFeePerGas:t.multiply(e-n)+n,maxPriorityFeePerGas:n}}};async function oo(t,e){const n=await t.request({method:"eth_gasPrice",params:[e]});return BigInt(n)}async function io(t,e){const n=await t.request({method:"eth_maxPriorityFeePerGas",params:[e]});return BigInt(n)}function er(t){return t===0||t===0n||t===void 0||t===null||t==="0"||t===""||typeof t=="string"&&(en(t).toLowerCase()==="0x"||en(t).toLowerCase()==="0x00")}function Me(t){return!er(t)}function co(t){return typeof t.maxFeePerGas<"u"&&typeof t.maxPriorityFeePerGas<"u"}function tr(t){return t.type==="cip64"?!0:co(t)&&Me(t.feeCurrency)}const uo={block:Pr({format(t){return{transactions:t.transactions?.map(n=>typeof n=="string"?n:{...Nr(n),...n.gatewayFee?{gatewayFee:gt(n.gatewayFee),gatewayFeeRecipient:n.gatewayFeeRecipient}:{},feeCurrency:n.feeCurrency})}}}),transaction:zr({format(t){if(t.type==="0x7e")return{isSystemTx:t.isSystemTx,mint:t.mint?gt(t.mint):void 0,sourceHash:t.sourceHash,type:"deposit"};const e={feeCurrency:t.feeCurrency};return t.type==="0x7b"?e.type="cip64":(t.type==="0x7c"&&(e.type="cip42"),e.gatewayFee=t.gatewayFee?gt(t.gatewayFee):null,e.gatewayFeeRecipient=t.gatewayFeeRecipient),e}}),transactionRequest:Cr({format(t){const e={};return t.feeCurrency&&(e.feeCurrency=t.feeCurrency),tr(t)&&(e.type="0x7b"),e}})};function lo(t,e){return tr(t)?po(t,e):Bs(t,e)}const fo={transaction:lo};function po(t,e){yo(t);const{chainId:n,gas:r,nonce:s,to:o,value:u,maxFeePerGas:f,maxPriorityFeePerGas:i,accessList:a,feeCurrency:c,data:d}=t,p=[ue(n),s?ue(s):"0x",i?ue(i):"0x",f?ue(f):"0x",r?ue(r):"0x",o??"0x",u?ue(u):"0x",d??"0x",Ws(a),c,...Qs(t,e)];return Sr(["0x7b",_r(p)])}const ho=Kr;function yo(t){const{chainId:e,maxPriorityFeePerGas:n,gasPrice:r,maxFeePerGas:s,to:o,feeCurrency:u}=t;if(e<=0)throw new qr({chainId:e});if(o&&!et(o))throw new xt({address:o});if(r)throw new ve("`gasPrice` is not a valid CIP-64 Transaction attribute.");if(Me(s)&&s>ho)throw new Rr({maxFeePerGas:s});if(Me(n)&&Me(s)&&n>s)throw new Ur({maxFeePerGas:s,maxPriorityFeePerGas:n});if(Me(u)&&!et(u))throw new ve("`feeCurrency` MUST be a token address for CIP-64 transactions.");if(er(u))throw new ve("`feeCurrency` must be provided for CIP-64 transactions.")}const mo={blockTime:1e3,contracts:Hs,formatters:uo,serializers:fo,fees:ao},go=Z({...mo,id:42220,name:"Celo",nativeCurrency:{decimals:18,name:"CELO",symbol:"CELO"},rpcUrls:{default:{http:["https://forno.celo.org"]}},blockExplorers:{default:{name:"Celo Explorer",url:"https://celoscan.io",apiUrl:"https://api.celoscan.io/api"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:13112599}},testnet:!1}),wo=Z({id:100,name:"Gnosis",nativeCurrency:{decimals:18,name:"xDAI",symbol:"XDAI"},blockTime:5e3,rpcUrls:{default:{http:["https://rpc.gnosischain.com"],webSocket:["wss://rpc.gnosischain.com/wss"]}},blockExplorers:{default:{name:"Gnosisscan",url:"https://gnosisscan.io",apiUrl:"https://api.gnosisscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:21022491}}}),bo=Z({id:560048,name:"Hoodi",nativeCurrency:{name:"Hoodi Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc.hoodi.ethpandaops.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://hoodi.etherscan.io"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:2589}},testnet:!0}),Io=Z({id:747474,name:"Katana",network:"katana",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://rpc.katana.network"]}},blockExplorers:{default:{name:"katana explorer",url:"https://katanascan.com"}},testnet:!1}),Mo=Object.freeze(Object.defineProperty({__proto__:null,arbitrum:Vs,arbitrumSepolia:no,base:Dt,baseSepolia:Zs,berachain:ro,berachainBepolia:so,bsc:Gs,celo:go,gnosis:wo,hoodi:bo,katana:Io,mainnet:Lr,optimism:Js,optimismSepolia:Xs,polygon:ea,sepolia:ta},Symbol.toStringTag,{value:"Module"})),vo=[Dt,...Object.values(Mo).filter(t=>t&&t.id!==Dt.id)],nr=to;({...nr});({...nr});const ko=()=>"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in IntersectionObserverEntry.prototype&&"isVisible"in IntersectionObserverEntry.prototype;function jo(t={}){const{prefix:e="[Porto]"}=t,n=new Set;return{error:de(console.error,{prefix:e}),errorOnce:de(console.error,{memo:n,prefix:e}),log:de(console.log,{prefix:e}),logOnce:de(console.log,{memo:n,prefix:e}),warn:de(console.warn,{prefix:e}),warnOnce:de(console.warn,{memo:n,prefix:e})}}const gn=jo();function de(t,e={}){const{memo:n,prefix:r}=e;return(...s)=>{const o=s.join(" ");n?.has(o)||(n?.add(o),t(`${r} ${o}`))}}function Eo(){const t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")}function Ao(){const t=navigator.userAgent.toLowerCase();return(t.includes("firefox")||t.includes("fxios"))&&!t.includes("seamonkey")}function xo(){return window.navigator?.userAgentData?.mobile?!0:navigator.maxTouchPoints>1||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.slice(0,4))}function Do(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),reject:e,resolve:t}}function he(t){if(Array.isArray(t))return t.map(he);if(typeof t=="function")return;if(typeof t!="object"||t===null)return t;if(Object.getPrototypeOf(t)!==Object.prototype)try{return structuredClone(t)}catch{return}const e={};for(const[n,r]of Object.entries(t))e[n]=he(r);return e}function rr(t,e){const n=[],r=new Set;for(const s of t){const o=e(s);r.has(o)||(r.add(o),n.push(s))}return n}function Gt(){return typeof globalThis<"u"&&"crypto"in globalThis?globalThis.crypto.randomUUID():crypto.randomUUID()}function se(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(se.cache.get(n))return se.cache.get(n);const r=t().finally(()=>se.cache.delete(n));return se.cache.set(n,r),r}(function(t){t.cache=new Map})(se||(se={}));function ot(t,e={}){const{targetOrigin:n}=e,r=new Map;return{destroy(){for(const s of r.values())t.removeEventListener("message",s)},on(s,o,u){function f(i){i.data.topic===s&&(u&&i.data.id!==u||n&&i.origin!==n||o(i.data.payload,i))}return t.addEventListener("message",f),r.set(s,f),()=>t.removeEventListener("message",f)},async send(s,o,u){const f=Gt();return t.postMessage(he({id:f,payload:o,topic:s}),u??n??"*"),{id:f,payload:o,topic:s}},async sendAsync(s,o,u){const{id:f}=await this.send(s,o,u);return new Promise(i=>this.on(s,i,f))}}}function sr(t){const{from:e,to:n,waitForReady:r=!1}=t;let s=!1;const o=Do();e.on("ready",o.resolve);const u={destroy(){e.destroy(),n.destroy(),s&&o.reject()},on(f,i,a){return e.on(f,i,a)},async send(f,i){return s=!0,r&&await o.promise.finally(()=>s=!1),n.send(f,i)},async sendAsync(f,i){return s=!0,r&&await o.promise.finally(()=>s=!1),n.sendAsync(f,i)}};return{...u,ready(f){u.send("ready",f)},waitForReady(){return o.promise}}}const ar={prod:"https://id.porto.sh/dialog"};function To(t={}){const{skipProtocolCheck:e,skipUnsupported:n}=t,r=s=>!n&&Eo()&&s?.some(o=>["wallet_connect","eth_requestAccounts"].includes(o.method));return typeof window>"u"?or():{name:"iframe",setup(s){const{host:o,internal:u,theme:f,themeController:i}=s,{store:a}=u,c=Oo().setup(s);let d=!1;const p=new URL(o),l=document.createElement("dialog");l.dataset.porto="",l.setAttribute("role","dialog"),l.setAttribute("aria-closed","true"),l.setAttribute("aria-label","Porto Wallet"),l.setAttribute("hidden","until-found"),Object.assign(l.style,{background:"transparent",border:"0",outline:"0",padding:"0",position:"fixed"}),document.body.appendChild(l);const h=document.createElement("iframe");h.setAttribute("data-testid","porto");const m=["payment",`publickey-credentials-get ${p.origin}`,`publickey-credentials-create ${p.origin}`];Ao()||m.push("clipboard-write"),h.setAttribute("allow",m.join("; ")),h.setAttribute("tabindex","0"),h.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"),h.setAttribute("src",_t(o)),h.setAttribute("title","Porto"),Object.assign(h.style,{backgroundColor:"transparent",border:"0",colorScheme:"light dark",height:"100%",left:"0",position:"fixed",top:"0",width:"100%"});const y=document.createElement("style");y.innerHTML=`
        dialog[data-porto]::backdrop {
          background: transparent!important;
        }
      `,l.appendChild(y),l.appendChild(h);const g=sr({from:ot(window,{targetOrigin:p.origin}),to:ot(h.contentWindow,{targetOrigin:p.origin}),waitForReady:!0});i?._setup(g,!0);const b=window.matchMedia("(max-width: 460px)"),w=()=>{g.send("__internal",{type:"resize",width:b.matches?460:461})};b.addEventListener("change",w),g.on("ready",x=>{let R=s.internal.store.getState().chainIds.filter(Q=>x.chainIds.includes(Q));R.length===0&&(R=x.chainIds),a.setState(Q=>({...Q,chainIds:R})),g.send("__internal",{chainIds:R,mode:"iframe",referrer:Ze(),theme:f,type:"init"}),w()}),g.on("rpc-response",x=>{if(r([x._request])){const K=h.src;h.src=K}cr(a,x)}),g.on("__internal",x=>{x.type==="switch"&&x.mode==="popup"&&(c.open(),c.syncRequests(a.getState().requestQueue))});let I=null,M=null;const v=()=>it(a),k=x=>{x.key==="Escape"&&it(a)},j=new MutationObserver(x=>{for(const K of x){if(K.type!=="attributes")continue;const R=K.attributeName;R&&R==="inert"&&l.removeAttribute(R)}});j.observe(l,{attributeOldValue:!0,attributes:!0});let E=!1;const A=()=>{E&&(E=!1,l.removeEventListener("click",v),document.removeEventListener("keydown",k),l.style.pointerEvents="none",M?.focus(),M=null,Object.assign(document.body.style,I??""),document.body.style.overflow=I?.overflow??"")},D=()=>{E||(E=!0,l.addEventListener("click",v),document.addEventListener("keydown",k),h.focus(),l.style.pointerEvents="auto",I=Object.assign({},document.body.style),document.body.style.overflow="hidden")};let O=!1;const T=()=>{O||(O=!0,document.activeElement instanceof HTMLElement&&(M=document.activeElement),l.removeAttribute("hidden"),l.removeAttribute("aria-closed"),l.showModal())},C=()=>{if(O){O=!1,l.setAttribute("hidden","true"),l.setAttribute("aria-closed","true"),l.close();for(const x of l.parentNode?Array.from(l.parentNode.children):[])x!==l&&x.hasAttribute("inert")&&x.removeAttribute("inert")}};return{close(){c.close(),d=!1,g.send("__internal",{mode:"iframe",referrer:Ze(),type:"init"}),C(),A()},destroy(){c.close(),d=!1,A(),C(),c.destroy(),g.destroy(),l.remove(),j.disconnect(),b.removeEventListener("change",w)},open(){d||(d=!0,T(),D(),g.send("__internal",{mode:"iframe",referrer:Ze(),type:"init"}))},async secure(){const{trustedHosts:x}=await g.waitForReady(),K=(()=>{if(e)return!0;const H=window.location.protocol.startsWith("https");return H||gn.warnOnce("Detected insecure protocol (HTTP).",`

The Porto iframe is not supported on HTTP origins (${window.location.origin})`,"due to lack of WebAuthn support.","See https://porto.sh/sdk#secure-origins-https for more information."),H})(),R=ko(),Q=!!x?.includes(window.location.hostname),U=!!(R||Q);return U||gn.warnOnce([`Warning: Browser does not support IntersectionObserver v2 or host "${p.hostname}" is not trusted by Porto.`,"This may result in the dialog falling back to a popup.","",`Add "${p.hostname}" to the trusted hosts list to enable iframe dialog: https://github.com/ithacaxyz/porto/edit/main/src/trusted-hosts.ts`].join(`
`)),{frame:U,host:Q,protocol:K}},async syncRequests(x){const{methodPolicies:K}=await g.waitForReady(),R=await this.secure(),Q=x?.every(H=>K?.find(mt=>mt.method===H.request.method)?.modes?.headless===!0),U=r(x.map(H=>H.request));if(!Q&&(U||!R.protocol||!R.frame))c.syncRequests(x);else{const H=x.some(mt=>ir(mt.request,{methodPolicies:K,targetOrigin:p.origin}));!d&&H&&this.open(),g.send("rpc-requests",x)}}}},supportsHeadless:!0}}function Oo(t={}){if(typeof window>"u")return or();const{type:e="auto",size:n=Co}=t;return{name:"popup",setup(r){const{host:s,internal:o,themeController:u}=r,{store:f}=o,i=new URL(s);let a=null;const c=e==="page"||e==="auto"&&xo()?"page":"popup";function d(){a&&it(f)}const p=(()=>{const h=setInterval(()=>{a?.closed&&it(f)},100);return()=>clearInterval(h)})();let l;return u?._setup(null,!0),{close(){a&&(a.close(),a=null)},destroy(){this.close(),window.removeEventListener("focus",d),l?.destroy(),p()},open(){if(c==="popup"){const h=(window.innerWidth-n.width)/2+window.screenX,m=window.screenY+100;a=window.open(_t(s),"_blank",`width=${n.width},height=${n.height},left=${h},top=${m}`)}else a=window.open(_t(s),"_blank");if(!a)throw new Error("Failed to open popup");l=sr({from:ot(window,{targetOrigin:i.origin}),to:ot(a,{targetOrigin:i.origin}),waitForReady:!0}),u?._setup(l,!1),l.send("__internal",{mode:c==="page"?"page":"popup",referrer:Ze(),theme:u?.getTheme()??r.theme,type:"init"}),l.on("rpc-response",h=>cr(f,h)),window.removeEventListener("focus",d),window.addEventListener("focus",d)},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(h){h.some(y=>ir(y.request))&&((!a||a.closed)&&this.open(),a?.focus()),l?.send("rpc-requests",h)}}},supportsHeadless:!1}}function or(){return{name:"noop",setup(){return{close(){},destroy(){},open(){},async secure(){return{frame:!0,host:!0,protocol:!0}},async syncRequests(){}}},supportsHeadless:!0}}const Co={height:282,width:360};function ir(t,e={}){const{methodPolicies:n,targetOrigin:r}=e,s=n?.find(o=>o.method===t.method);return s&&s.modes?.headless?!!(typeof s.modes.headless=="object"&&s.modes.headless.sameOrigin&&r!==window.location.origin):!0}function Ze(){return{icon:(()=>{const e=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: dark)"]')?.href,n=document.querySelector('link[rel="icon"][media="(prefers-color-scheme: light)"]')?.href??document.querySelector('link[rel="icon"]')?.href;return e&&n&&e!==n?{dark:e,light:n}:window.matchMedia("(prefers-color-scheme: dark)").matches?e:n})(),title:document.title}}function it(t){t.setState(e=>({...e,requestQueue:e.requestQueue.map(n=>({account:n.account,error:new pe,request:n.request,status:"error"}))}))}function cr(t,e){t.setState(n=>({...n,requestQueue:n.requestQueue.map(r=>r.request.id!==e.id?r:e.error?{account:r.account,error:e.error,request:r.request,status:"error"}:{account:r.account,request:r.request,result:e.result,status:"success"})}))}function _t(t){const e=new URL(t),n=new URLSearchParams(window.location.search),r="porto.";for(const[s,o]of n.entries())s.startsWith(r)&&e.searchParams.set(s.slice(r.length),o);return e.toString()}function zo(t){if(typeof t=="string"){if(!et(t,{strict:!1}))throw new xt({address:t});return{address:t,type:"json-rpc"}}if(!et(t.address,{strict:!1}))throw new xt({address:t.address});return{address:t.address,nonceManager:t.nonceManager,sign:t.sign,signAuthorization:t.signAuthorization,signMessage:t.signMessage,signTransaction:t.signTransaction,signTypedData:t.signTypedData,source:"custom",type:"local"}}const ur="0x3232323232323232323232323232323232323232",wn="0x32323232",Po={p256:"p256",secp256k1:"secp256k1",webauthnp256:"webauthn-p256"},No={admin:"admin",normal:"session"},So={0:"minute",1:"hour",2:"day",3:"week",4:"month",5:"year"},_o={address:"secp256k1",p256:"p256",secp256k1:"secp256k1","webauthn-p256":"webauthnp256"},qo={admin:"admin",session:"normal"},Ro={address:2,p256:0,secp256k1:2,"webauthn-p256":1},bn={day:2,hour:1,minute:0,month:4,week:3,year:5};function Uo(t={}){const e=Fn();return Lo({...t,privateKey:e})}async function In(t){const{createFn:e,label:n,rpId:r,userId:s}=t,o=await Qa({authenticatorSelection:{requireResidentKey:!0,residentKey:"required",userVerification:"required"},createFn:e,extensions:{credProps:!0},rp:r?{id:r,name:r}:void 0,user:{displayName:n,id:new Uint8Array(s??Yt(n)),name:n}});return dr({...t,credential:{id:o.id,publicKey:o.publicKey},id:s?Bt(s):Le(o.publicKey,{includePrefix:!1})})}function Mn(t={}){const e=Fn();return Fo({...t,privateKey:e})}async function Ko(t={}){const e=await Xa();return Yo({...t,keyPair:e})}function Y(t,e={}){const{chainId:n=t.chainId}=e,{expiry:r=0,id:s,prehash:o=!1,role:u="admin",type:f}=t,i=(()=>{const a=t.publicKey;return a==="0x"?a:f==="secp256k1"||f==="address"?fe(a)===20||Wt(Ee(a,0,12))===0n?Ee(a,-20):_n(qn(a)):a})();return{...t,chainId:n,expiry:r,hash:lr({publicKey:i,type:f}),id:(s??i).toLowerCase(),prehash:o,publicKey:i.toLowerCase(),role:u,type:f}}function Lo(t){const{chainId:e,expiry:n,feeToken:r,permissions:s,privateKey:o,role:u}=t,f=Le($n({privateKey:o}),{includePrefix:!1});return Y({chainId:e,expiry:n,feeToken:r,permissions:s,privateKey(){return o},publicKey:f,role:u,type:"p256"})}function $o(t,e){const{chainId:n}=e,{publicKey:r}=t,s=fe(r)===20||Wt(Ee(r,0,12))===0n,o={};for(const u of t.permissions)u.type==="call"&&(o.calls??=[],o.calls.push({signature:u.selector,to:u.to===ur?void 0:u.to})),u.type==="spend"&&(o.spend??=[],o.spend.push({limit:u.limit,period:u.period,token:u.token}));return Y({chainId:n,expiry:t.expiry,permissions:o,publicKey:t.publicKey,role:No[t.role],type:s?"address":Po[t.type]})}function dr(t){const{credential:e,id:n,rpId:r}=t,s=Le(e.publicKey,{includePrefix:!1});return Y({chainId:t.chainId,expiry:t.expiry??0,feeToken:t.feeToken,id:n,permissions:t.permissions,privateKey:{credential:e,rpId:r},publicKey:s,role:t.role,type:"webauthn-p256"})}function Fo(t){const{privateKey:e}=t,n=Le($n({privateKey:e}),{includePrefix:!1});return Y({chainId:t.chainId,expiry:t.expiry??0,feeToken:t.feeToken,permissions:t.permissions,privateKey:{privateKey(){return e}},publicKey:n,role:t.role,type:"webauthn-p256"})}function Yo(t){const{chainId:e,expiry:n,feeToken:r,keyPair:s,permissions:o,role:u}=t,{privateKey:f}=s,i=Le(s.publicKey,{includePrefix:!1});return Y({chainId:e,expiry:n,feeToken:r,permissions:o,prehash:!0,privateKey:f,publicKey:i,role:u,type:"p256"})}function lr(t){const{type:e}=t,n=fr(t.publicKey);return L(lt([{type:"uint8"},{type:"bytes32"}],[Ro[e],L(n)]))}function fr(t){return fe(t)<32?Br(t,32):t}async function ae(t,e){const{address:n,storage:r,webAuthn:s,wrap:o=!0}=e,{privateKey:u,publicKey:f,type:i}=t;if(!u)throw new Error(`Key does not have a private key to sign with.

Key:
`+xe(t,null,2));const a=n?Zt({domain:{verifyingContract:n},message:{digest:e.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):e.payload,[c,d]=await(async()=>{if(i==="p256"){const{privateKey:p}=t;if(typeof p=="function")return[Ve(pn({payload:a,privateKey:p()})),!1];if(p instanceof CryptoKey)return[Ve(await eo({payload:a,privateKey:p})),!0]}if(i==="secp256k1")return[Ve(Sn({payload:a,privateKey:u()})),!1];if(i==="webauthn-p256"){if(u.privateKey){const{payload:E,metadata:A}=Ja({challenge:a,origin:"https://ithaca.xyz",rpId:"ithaca.xyz"}),{r:D,s:O}=pn({hash:!0,payload:E,privateKey:u.privateKey()});return[qt({metadata:A,signature:{r:D,s:O}}),!1]}const{credential:p,rpId:l}=u,h=`porto.webauthnVerified.${t.hash}`,m=Date.now(),y=600*1e3;let g=!0;if(r){const E=await r.getItem(h);g=!E||m-E>y}const{signature:{r:b,s:w},raw:I,metadata:M}=await Xn({challenge:a,credentialId:p.id,getFn:s?.getFn,rpId:l,userVerification:g?"required":"preferred"}),v=I.response;if(!v?.userHandle)throw new Error("No user handle in response",{cause:{response:v}});const k=Bt(new Uint8Array(v.userHandle));if(t.id&&dt(t.id)&&!P(t.id,k))throw new Error(`supplied webauthn key "${t.id}" does not match signature webauthn key "${k}"`,{cause:{id:k,key:t}});return g&&r&&await r.setItem(h,m),[qt({metadata:M,signature:{r:b,s:w}}),!1]}throw new Error(`Key type "${i}" is not supported.

Key:
`+xe(t,null,2))})();return o?hr(c,{keyType:i,prehash:d,publicKey:f}):c}function ct(t,e={}){const{expiry:n=0,prehash:r=!1,publicKey:s,role:o="admin",type:u}=t,{feeTokens:f,orchestrator:i}=e,a=Object.entries(pr(t,{feeTokens:f})).map(([c,d])=>{if(c==="calls")return d.map(({signature:l,to:h})=>({selector:l?Ft(l)?l:Yr(l):wn,to:h??ur,type:"call"}));if(c!=="feeToken"){if(c==="spend")return d.map(({limit:l,period:h,token:m})=>({limit:l,period:h,token:m,type:"spend"}));throw new Error(`Invalid permission type "${c}".`)}}).flat().filter(Boolean);return t.role==="session"&&i&&a.push({selector:wn,to:i,type:"call"}),{expiry:n,permissions:a??[],prehash:r,publicKey:fr(s),role:qo[o],type:_o[u]}}function pr(t,e){const{permissions:n}=t,r=n?.calls?[...n.calls]:[],s=n?.spend?[...n.spend]:[],o=e.feeTokens?.filter(u=>u.feeToken);if(o&&o.length>0){const u=Bo(t,{feeTokens:o});if(u){let f=-1,i=bn.year;for(let a=0;a<s.length;a++){const c=s[a];if(c.token&&P(u.address,c.token)){f=a;break}if(!c.token&&u.address===De){f=a;break}const d=bn[c.period];d<i&&(i=d)}f!==-1?(s[f]={...s[f],limit:s[f].limit+u.value},s.unshift(s.splice(f,1)[0])):typeof i=="number"&&s.unshift({limit:u.value,period:So[i],token:u.address})}}return{...n,calls:r,spend:s}}function Bo(t,e){const{feeTokens:n}=e;if(!t.feeToken)return;const r=n.find(o=>t.feeToken.symbol===o.symbol?!0:t.feeToken.symbol?t.feeToken.symbol==="native"?o.address===De:!1:o.address===De);if(!r)return;const s=Qn(t.feeToken.limit,r.decimals);return{...r,value:s}}function qt(t){const{metadata:e,signature:n}=t;return lt(Fr(["struct WebAuthnAuth { bytes authenticatorData; string clientDataJSON; uint256 challengeIndex; uint256 typeIndex; bytes32 r; bytes32 s; }","WebAuthnAuth auth"]),[{authenticatorData:e.authenticatorData,challengeIndex:BigInt(e.challengeIndex),clientDataJSON:e.clientDataJSON,r:N(n.r,{size:32}),s:N(n.s,{size:32}),typeIndex:BigInt(e.typeIndex)}])}function hr(t,e){const{keyType:n,prehash:r=!1,publicKey:s}=e,o=lr({publicKey:s,type:n});return $r(["bytes","bytes32","bool"],[t,o,r])}function $(t){const e=typeof t=="string"?{address:t}:t,n=e.sign?"privateKey":"porto",{address:r,sign:s,signMessage:o,signTransaction:u,signTypedData:f,type:i}=zo({address:e.address,sign({hash:a}){if(n==="porto")throw new Error("`sign` not supported on porto accounts.");if(!e.sign)throw new Error("`sign` not supported.");return e.sign({hash:a})},signMessage({message:a}){return this.sign({hash:Qr(a)})},signTransaction(){throw new Error("`signTransaction` not supported on porto accounts.")},signTypedData(a){return this.sign({hash:Wr(a)})}});return{address:r,keys:e.keys??void 0,sign:s,signMessage:o,signTransaction:u,signTypedData:f,source:n,type:i}}function Wo(t,e={}){const{keys:n}=e,r=_n(Hr({privateKey:t}));return $({address:r,keys:n,async sign({hash:s}){return Ve(Sn({payload:s,privateKey:t}))},source:"privateKey"})}function yt(t,e={}){const{key:n,role:r}=e;if(n!==null){if(typeof n=="object")return n;if(t.keys&&t.keys.length>0)return typeof n=="number"?t.keys[n]:t.keys.find(s=>s.privateKey&&(!r||s.role===r))}}async function me(t,e){const{storage:n,replaySafe:r=!0,wrap:s=!0,webAuthn:o}=e,u=yt(t,e),f=r?Zt({domain:{verifyingContract:t.address},message:{digest:e.payload},primaryType:"ERC1271Sign",types:{ERC1271Sign:[{name:"digest",type:"bytes32"}]}}):e.payload,i=u?({hash:a})=>ae(u,{address:null,payload:a,storage:n,webAuthn:o,wrap:s}):t.source==="privateKey"?t.sign:void 0;if(!i)throw new Error("cannot find key to sign with.");return await i({hash:f})}class Qo extends ve{constructor(){super("Function is not recognized.",{metaMessages:["This could be due to any of the following:","  - The contract does not have the function,","  - The address is not a contract."],name:"FunctionSelectorNotRecognizedError"})}}function Ho(t,e){const n=t.walk(s=>"data"in s);if(!n?.data)return t;if(n.data===ia(ht("error FnSelectorNotRecognized()")))return new Qo;let r=null;for(const s of e.calls){const o=s;if(o.abi)try{if(!!!Vr({abi:o.abi,data:n.data}))continue;r=o}catch{}}return r?Zr(n,{abi:r.abi,address:r.to,args:r.args,functionName:r.functionName}):t}async function Vo(t,e){try{const n="wallet_getAuthorization",r=await ft(()=>t.request({method:n,params:[z(sn.Parameters,e)]}),{cacheKey:`${t.uid}.${n}.${e.address}`});return q(sn.Response,r)}catch(n){throw W(n),n}}async function Ue(t,e={}){const n=(()=>{if(e.chainId)return[e.chainId];if(e.chainIds!=="all")return e.chainIds?e.chainIds:[t.chain.id]})();try{const r="wallet_getCapabilities",s=await ft(()=>t.request({method:r,params:n?[n]:void 0},{retryCount:0}),{cacheKey:`${t.uid}.${r}.${n?.join(",")}`}),o=e.raw?s:q(Jr.Response,s);return e.chainIds?o:Object.values(o)[0]}catch(r){throw W(r),r}}async function Zo(t,e){const{account:n,assetFilter:r,assetTypeFilter:s,chainFilter:o}=e;try{const f=await t.request({method:"wallet_getAssets",params:[z(nn.Parameters,{account:n,assetFilter:r,assetTypeFilter:s,chainFilter:o})]}),i=q(nn.Response,f),a=Object.entries(i).reduce((d,[p,l])=>(d[ke(p)]=l,d),{}),c={};for(const d of Object.values(a))for(const p of d){const l=JSON.stringify(p.metadata);c[l]={...p,balance:p.balance+(c[l]?.balance??0n)}}return{...a,0:Object.values(c)}}catch(u){throw W(u),u}}async function Go(t,e){const{id:n}=e;try{const s=await t.request({method:"wallet_getCallsStatus",params:[n]});return q(Xr.Response,s)}catch(r){throw W(r),r}}async function Jo(t,e){const{address:n,chainIds:r}=e;try{const o=await t.request({method:"wallet_getKeys",params:[z(un.Parameters,{address:n,chainIds:r})]});return q(un.Response,o)}catch(s){throw W(s),s}}async function Xo(t){const e="health",n=await ft(()=>t.request({method:e}),{cacheKey:`${t.uid}.${e}`});return q(as.Response,n)}async function bt(t,e){const{address:n,capabilities:r,chain:s=t.chain,key:o}=e,u=e.calls.map(f=>({data:f.abi?ts(ns(f.abi,f.functionName),f.args):f.data??"0x",to:f.to,value:f.value??0n}));try{const i=await t.request({method:"wallet_prepareCalls",params:[z(cn.Parameters,{calls:u,capabilities:{...r,meta:{...r?.meta}},chainId:s?.id,from:n,key:o?{prehash:o.prehash,publicKey:o.publicKey,type:o.type}:void 0})]},{retryCount:0});return Object.assign(q(cn.Response,i),{_raw:i})}catch(f){throw W(f),ye(f,{calls:e.calls}),f}}async function ei(t,e){const{address:n,chain:r=t.chain,delegation:s,...o}=e;try{const f=await t.request({method:"wallet_prepareUpgradeAccount",params:[z(on.Parameters,he({address:n,capabilities:o,chainId:r?.id,delegation:s}))]},{retryCount:0});return q(on.Response,f)}catch(u){throw W(u),ye(u),u}}async function ti(t,e){const{capabilities:n,context:r,key:s,signature:o}=e;try{const f=await t.request({method:"wallet_sendPreparedCalls",params:[z(an.Parameters,{capabilities:n,context:{preCall:r.preCall,quote:r.quote},key:s?{prehash:s.prehash,publicKey:s.publicKey,type:s.type}:void 0,signature:o})]},{retryCount:0});return q(an.Response,f)}catch(u){throw W(u),ye(u),u}}async function ni(t,e){const{email:n,walletAddress:r}=e;try{const o=await t.request({method:"account_setEmail",params:[z(dn.Parameters,{email:n,walletAddress:r})]},{retryCount:0});return q(dn.Response,o)}catch(s){throw W(s),ye(s),s}}async function ri(t,e){const{context:n,signatures:r}=e;try{await t.request({method:"wallet_upgradeAccount",params:[z(es.Parameters,{context:n,signatures:r})]},{retryCount:0})}catch(s){throw W(s),ye(s),s}}async function si(t,e){const{chainId:n,email:r,signature:s,token:o,walletAddress:u}=e;try{const i=await t.request({method:"account_verifyEmail",params:[z(rn.Parameters,{chainId:n,email:r,signature:s,token:o,walletAddress:u})]},{retryCount:0});return q(rn.Response,i)}catch(f){throw W(f),ye(f),f}}async function ai(t,e){const{signature:n}=e,{signature:r,capabilities:{feeSignature:s,...o},...u}=e.response,f=Rt({capabilities:o,...u}),i=L(G(JSON.stringify(f))),a=rs({payload:i,signature:ss(n)}),{quoteSigner:c}=await Xo(t);return a===c}async function oi(t,e){const{address:n,chain:r=t.chain,digest:s,signature:o}=e;try{async function u(){return{proof:null,valid:await Gr(t,{address:n,hash:s,signature:o})}}const f="wallet_verifySignature",i=await(async()=>{const a=await t.request({method:f,params:[z(tn.Parameters,{address:n,chainId:r?.id,digest:s,signature:o})]},{retryCount:0}).catch(u);return a.valid?a:u()})();return q(tn.Response,i)}catch(u){throw W(u),u}}function ye(t,{calls:e}={}){if(!(t instanceof ve))return;const n=o=>{try{if(o.name==="ContractFunctionExecutionError"){const a=o.cause.name==="ContractFunctionRevertedError"?o.cause.data:void 0;if(a)return oa([a.abiItem],a.errorName)}const u=o.walk(a=>!(a instanceof Error)&&a.code===3);if(!u)return;const{data:f,message:i}=u;return f==="0xd0d5039b"?ht("error Unauthorized()"):{inputs:[],name:(i??f).split("(")[0],type:"error"}}catch{return}},r=Ho(t,{calls:e??[]}),s=n(r);if(!(r===t&&!s))throw new ii(Object.assign(r,{abiError:s}))}function Rt(t){if(typeof t=="object"&&t!==null){if(Array.isArray(t))return t.map(Rt);const e={};for(const n of Object.keys(t).sort())e[n]=Rt(t[n]);return e}return t}function W(t){if(t.name==="$ZodError")throw Rn(t)}class ii extends V{constructor(e){super("An error occurred while executing calls.",{cause:e,metaMessages:[e.abiError&&"Reason: "+e.abiError.name].filter(Boolean)}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Rpc.ExecutionError"}),Object.defineProperty(this,"abiError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiError=e.abiError}}const ci={prod:{http:"https://rpc.porto.sh"}};function Ke(t){return e=>{const n=t.public(e),r=t.relay(e);return os({key:Ke.type,name:"Relay Proxy",async request({method:s,params:o},u){return ui(s)?r.request({method:s,params:o},u):n.request({method:s,params:o},u)},type:Ke.type})}}(function(t){t.type="relayProxy"})(Ke||(Ke={}));function ui(t){return!!(t.startsWith("wallet_")||t.startsWith("account_")||t==="health")}const It=new Map;function di(t,e={}){const{config:n,id:r,store:s}=t._internal,{chains:o,relay:u}=n,f=s.getState(),i=e.chainId??f.chainIds[0],a=o.find(l=>l.id===i);if(!a)throw new Error(["Could not find a compatible Porto chain on the given chain configuration.","",`Provided chains: [${o.map(l=>`${l.name} (id: ${l.id})`).join(", ")}]`,`Needed chain (id): ${i}`,"Please add this chain (id) to your chain configuration."].join(`
`));const c=Ke({public:n.transports[a.id]??is(a.rpcUrls.default.http.map(l=>pt(l))),relay:u}),d=[r,xe(a)].filter(Boolean).join(":");if(It.has(d))return It.get(d);const p=Un({...e,chain:a,pollingInterval:1e3,transport:c});return It.set(d,p),p}const Ut=cs;function yr(t,e){const{chainId:n,expiry:r,permissions:s,id:o,publicKey:u,type:f}=t,{address:i}=e;return{address:i,chainId:n,expiry:r,id:o,key:{publicKey:u,type:f},permissions:s??{}}}function vn(t){const{chainId:e,expiry:n,key:r}=t;return Y({chainId:e,expiry:n,permissions:t.permissions??{},publicKey:r.publicKey,role:"session",type:r.type})}const kn=ds("method",[ls.Request,fs.Request,ps.Request,hs.Request,ys.Request,ms.Request,gs.Request,ws.Request,Qt.Request,bs.Request,Kn.Request,Ln.Request,Is.Request,Ms.Request,vs.Request,ks.Request,js.Request,Es.Request,As.Request,xs.Request,Ht.Request,Ds.Request,Ts.Request,tt.Request,nt.Request,Os.Request,Cs.Request,zs.Request,Ps.Request]);function jn(t,e){const n=us(t,e);if(n.error){const r=n.error.issues.at(0);throw r?.code==="invalid_union"&&r.note==="No matching discriminator"?new ie:new ce(Rn(n.error))}return{...e,_decoded:n.data}}async function En(t){t.persist.hasHydrated()||await new Promise(e=>{t.persist.onFinishHydration(()=>e(!0)),setTimeout(()=>e(!0),100)})}function Mt(t){if(t)return t.startsWith("/")?`${window.location.origin}${t}`:t}function li(t){const{config:e,getMode:n,id:r,store:s}=t,{announceProvider:o}=e;function u(h={}){const m=f(),y=h.request??jn(kn,{method:"wallet_getCapabilities",params:h.chainIds?[void 0,h.chainIds]:void 0});return ft(()=>n().actions.getCapabilities({chainIds:h.chainIds,internal:{client:m,config:e,request:y,store:s}}),{cacheKey:`getCapabilities.${r}.${h.chainIds?.join(",")}`})}function f(h){const m=typeof h=="string"?ke(h):h;return di({_internal:t},{chainId:m})}const i=new Map,a=[],c=ba(),d=Bn({...c,async request(h){await En(s);const m=["eth_accounts","eth_chainId","eth_requestAccounts","wallet_getAssets","wallet_getCapabilities","wallet_getKeys","wallet_getPermissions","wallet_getAccountVersion","wallet_connect"].includes(h.method);return se(async()=>{let y;try{y=jn(kn,h)}catch(b){const w=b;if(!(w instanceof ie))throw w;if(h.method.startsWith("wallet_"))throw new qe;return f().request(h)}const g=s.getState();switch(y.method){case"account_verifyEmail":{if(g.accounts.length===0)throw new _;const[b]=y._decoded.params,{chainId:w,email:I,token:M,walletAddress:v}=b,k=f(w);if(w&&w!==k.chain.id)throw new ee;const j=v?g.accounts.find(E=>P(E.address,v)):g.accounts[0];if(!j)throw new S;return await n().actions.verifyEmail({account:j,chainId:w,email:I,internal:{client:k,config:e,request:y,store:s},token:M,walletAddress:v})}case"wallet_addFunds":{if(g.accounts.length===0)throw new _;const{address:b,value:w,token:I}=y.params[0]??{},M=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!M)throw new S;const v=f(),k=await n().actions.addFunds({address:M.address,internal:{client:v,config:e,request:y,store:s},token:I,value:w});return c.emit("message",{data:null,type:"assetsChanged"}),k}case"eth_accounts":{if(g.accounts.length===0)throw new _;return g.accounts.map(we)}case"eth_chainId":return N(g.chainIds[0]);case"eth_requestAccounts":{if(g.accounts.length>0&&i.get("eth_requestAccounts"))return g.accounts.map(we);const b=f(),{accounts:w}=await n().actions.loadAccounts({internal:{client:b,config:e,request:y,store:s}});return s.setState(I=>({...I,accounts:w})),c.emit("connect",{chainId:N(b.chain.id)}),i.set("eth_requestAccounts",!0),setTimeout(()=>i.delete("eth_requestAccounts"),1e3),w.map(we)}case"eth_sendTransaction":{if(g.accounts.length===0)throw new _;const[{capabilities:b,chainId:w,data:I="0x",from:M,to:v,value:k}]=y._decoded.params,j=f(w);if(w&&w!==j.chain.id)throw new ee;const E=M?g.accounts.find(D=>P(D.address,M)):g.accounts[0];if(!E)throw new S;const{id:A}=await n().actions.sendCalls({account:E,asTxHash:!0,calls:[{data:I,to:v,value:k}],chainId:j.chain.id,internal:{client:j,config:e,request:y,store:s},merchantUrl:Mt(e.merchantUrl??b?.merchantUrl)});return A}case"eth_signTypedData_v4":{if(g.accounts.length===0)throw new _;const[b,w]=y._decoded.params,I=g.accounts.find(k=>P(k.address,b));if(!I)throw new S;const M=f();return await n().actions.signTypedData({account:I,data:w,internal:{client:M,config:e,request:y,store:s}})}case"wallet_grantAdmin":{if(g.accounts.length===0)throw new _;const[{address:b,capabilities:w,chainId:I,key:M}]=y._decoded.params??[{}],v=b?g.accounts.find(D=>P(D.address,b)):g.accounts[0];if(!v)throw new S;const k=f(I);if(ge([...v.keys??[]])?.some(D=>D.publicKey?.toLowerCase()===M.publicKey.toLowerCase()))throw new ce({message:"Key already granted as admin."});const{key:E}=await n().actions.grantAdmin({account:v,feeToken:w?.feeToken,internal:{client:k,config:e,request:y,store:s},key:M});s.setState(D=>{const O=D.accounts.findIndex(T=>v?P(T.address,v.address):!0);return O===-1?D:{...D,accounts:D.accounts.map((T,C)=>C===O?{...T,keys:[...T.keys??[],E]}:T)}});const A=ge([...v.keys??[],E]);return c.emit("message",{data:null,type:"adminsChanged"}),z(Kn.Response,{address:v.address,chainId:k.chain.id,key:A.at(-1)})}case"wallet_grantPermissions":{if(g.accounts.length===0)throw new _;const[{address:b,chainId:w,...I}]=y._decoded.params??[{}],M=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!M)throw new S;const v=f(w),{key:k}=await n().actions.grantPermissions({account:M,internal:{client:v,config:e,request:y,store:s},permissions:I});return s.setState(j=>{const E=j.accounts.findIndex(A=>M?P(A.address,M.address):!0);return E===-1?j:{...j,accounts:j.accounts.map((A,D)=>D===E?{...A,keys:[...A.keys??[],k]}:A)}}),c.emit("message",{data:null,type:"permissionsChanged"}),z(Ln.Response,{...yr(k,{address:M.address})})}case"wallet_getAdmins":{if(g.accounts.length===0)throw new _;const[{address:b,chainId:w}]=y._decoded.params??[{}],I=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!I)throw new S;const M=f(w),v=await n().actions.getKeys({account:I,internal:{client:M,config:e,request:y,store:s}}),k=ge(v);return z(Qt.Response,{address:I.address,chainId:M.chain.id,keys:k})}case"wallet_prepareUpgradeAccount":{const[{address:b,capabilities:w,chainId:I}]=y._decoded.params??[{}],{email:M,label:v,grantPermissions:k}=w??{},j=f(I),{context:E,digests:A}=await n().actions.prepareUpgradeAccount({address:b,email:M,internal:{client:j,config:e,request:y,store:s},label:v,permissions:k});return a.push(E.account),{context:E,digests:A}}case"wallet_getAccountVersion":{if(g.accounts.length===0)throw new _;const[{address:b}]=y._decoded.params??[{}],w=b?g.accounts.find(k=>P(k.address,b)):g.accounts[0];if(!w)throw new S;const I=f(),{current:M,latest:v}=await n().actions.getAccountVersion({address:w.address,internal:{client:I,config:e,request:y,store:s}});return{current:M,latest:v}}case"wallet_getKeys":{if(g.accounts.length===0)throw new _;const[{address:b,chainIds:w}]=y._decoded.params??[{}],I=g.accounts.find(k=>P(k.address,b));if(!I)throw new S;const M=f(),v=await n().actions.getKeys({account:I,chainIds:w,internal:{client:M,config:e,request:y,store:s}});return z(tt.Response,v)}case"wallet_getPermissions":{if(g.accounts.length===0)throw new _;const[{address:b,chainIds:w}]=y._decoded.params??[{}],I=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!I)throw new S;const M=f(),v=await n().actions.getKeys({account:I,chainIds:w,internal:{client:M,config:e,request:y,store:s}});return vt(v,{address:I.address})}case"wallet_revokeAdmin":{if(g.accounts.length===0)throw new _;const[{address:b,capabilities:w,id:I}]=y._decoded.params,M=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!M)throw new S;const v=f();await n().actions.revokeAdmin({account:M,feeToken:w?.feeToken,id:I,internal:{client:v,config:e,request:y,store:s}});const k=M.keys?.filter(j=>j.id.toLowerCase()!==I.toLowerCase());s.setState(j=>({...j,accounts:j.accounts.map(E=>P(E.address,M.address)?{...E,keys:k}:E)})),c.emit("message",{data:null,type:"adminsChanged"});return}case"wallet_revokePermissions":{if(g.accounts.length===0)throw new _;const[{address:b,capabilities:w,id:I}]=y._decoded.params,M=b?g.accounts.find(j=>P(j.address,b)):g.accounts[0];if(!M)throw new S;const v=f();await n().actions.revokePermissions({account:M,feeToken:w?.feeToken,id:I,internal:{client:v,config:e,request:y,store:s}});const k=M.keys?.filter(j=>j.id.toLowerCase()!==I.toLowerCase());s.setState(j=>({...j,accounts:j.accounts.map(E=>P(E.address,M.address)?{...E,keys:k}:E)})),c.emit("message",{data:null,type:"permissionsChanged"});return}case"wallet_upgradeAccount":{const[{context:b,signatures:w}]=y._decoded.params??[{}],I=f(),M=a.find(E=>P(E.address,b.account.address));if(!M)throw new S;const{account:v}=await n().actions.upgradeAccount({account:M,context:b,internal:{client:I,config:e,request:y,store:s},signatures:w}),k=ge(v.keys??[]),j=vt(v.keys??[],{address:v.address});return s.setState(E=>({...E,accounts:[v]})),c.emit("connect",{chainId:N(I.chain.id)}),{address:v.address,capabilities:{admins:k,...j.length>0?{permissions:j}:{}}}}case"porto_ping":return"pong";case"personal_sign":{if(g.accounts.length===0)throw new _;const[b,w]=y._decoded.params,I=g.accounts.find(k=>P(k.address,w));if(!I)throw new S;const M=f();return await n().actions.signPersonalMessage({account:I,data:b,internal:{client:M,config:e,request:y,store:s}})}case"wallet_connect":{const[{capabilities:b,chainIds:w}]=y._decoded.params??[{}],I=f(w?.[0]),M=I.chain.id,{createAccount:v,email:k,grantAdmins:j,grantPermissions:E,selectAccount:A,signInWithEthereum:D}=b??{},O={client:I,config:e,request:y,store:s},{accounts:T}=await(async()=>{if(k||v){const{label:U=void 0}=typeof v=="object"?v:{},{account:H}=await n().actions.createAccount({admins:j,email:k,internal:O,label:U,permissions:E,signInWithEthereum:D});return{accounts:[H]}}const x=g.accounts[0],{address:K,key:R}=(()=>{if(A)return typeof A=="object"?A:{address:void 0,key:void 0};for(const U of x?.keys??[])if(U.type==="webauthn-p256"&&U.role==="admin")return{address:x?.address,key:{credentialId:U.credentialId??U.privateKey?.credential?.id,publicKey:U.publicKey}};return{address:void 0,key:void 0}})(),Q={internal:O,permissions:E,signInWithEthereum:D};try{return await n().actions.loadAccounts({address:K,key:R,...Q})}catch(U){if(U instanceof pe)throw U;if(K&&R)return await n().actions.loadAccounts(Q);throw U}})();s.setState(x=>({...x,accounts:T}));const C=[M,...s.getState().chainIds.filter(x=>x!==M)];return c.emit("connect",{chainId:N(C[0])}),{accounts:T.map(x=>({address:we(x),capabilities:{admins:x.keys?ge(x.keys):[],permissions:x.keys?vt(x.keys,{address:x.address}):[],...x.signInWithEthereum&&{signInWithEthereum:x.signInWithEthereum}}})),chainIds:C.map(x=>N(x))}}case"wallet_disconnect":{const b=f();await n().actions.disconnect?.({internal:{client:b,config:e,request:y,store:s}}),s.setState(w=>({...w,accounts:[]})),c.emit("disconnect",new _);return}case"wallet_getAssets":{const[b]=y._decoded.params??[],{account:w,chainFilter:I,assetFilter:M,assetTypeFilter:v}=b,k=f(),j=await n().actions.getAssets({account:w,assetFilter:M,assetTypeFilter:v,chainFilter:I,internal:{client:k,config:e,request:y,store:s}}),E=Object.entries(j).reduce((A,[D,O])=>(A[N(Number(D))]=O,A),{});return z(Ht.Response,E)}case"wallet_getCallsStatus":{const[b]=y._decoded.params??[],w=f();return await n().actions.getCallsStatus({id:b,internal:{client:w,config:e,request:y,store:s}})}case"wallet_getCapabilities":{const[b,w]=y.params??[];return await u({chainIds:w,request:y})}case"wallet_prepareCalls":{const[b]=y._decoded.params,{calls:w,capabilities:I,chainId:M,key:v,from:k}=b,j=f(M),E=k??g.accounts[0];if(!E)throw new S;if(M&&M!==j.chain.id)throw new ee;const{digest:A,...D}=await n().actions.prepareCalls({account:$(E),calls:w,feeToken:I?.feeToken,internal:{client:j,config:e,request:y,store:s},key:v,merchantUrl:Mt(e.merchantUrl??I?.merchantUrl),requiredFunds:I?.requiredFunds});return z(nt.Response,{capabilities:D.capabilities,chainId:N(D.chainId??j.chain.id),context:{...D.context,account:{address:D.account.address},calls:D.context.calls??[],nonce:D.context.nonce??0n},digest:A,key:D.key,typedData:D.typedData})}case"wallet_sendPreparedCalls":{const[b]=y._decoded.params,{chainId:w,context:I,key:M,signature:v}=b,{account:k}=b.context,j=f(w);if(w&&ke(w)!==j.chain.id)throw new ee;return[{id:await n().actions.sendPreparedCalls({account:$(k),context:I,internal:{client:j,config:e,request:y,store:s},key:M,signature:v})}]}case"wallet_sendCalls":{if(g.accounts.length===0)throw new _;const[b]=y._decoded.params,{calls:w,capabilities:I,chainId:M,from:v}=b,k=f(M);if(M&&M!==k.chain.id)throw new ee;const j=v?g.accounts.find(A=>P(A.address,v)):g.accounts[0];if(!j)throw new S;const{id:E}=await n().actions.sendCalls({account:j,calls:w,chainId:k.chain.id,feeToken:I?.feeToken,internal:{client:k,config:e,request:y,store:s},merchantUrl:Mt(e.merchantUrl??I?.merchantUrl),permissionsId:I?.permissions?.id,requiredFunds:I?.requiredFunds});return{id:E}}case"wallet_switchEthereumChain":{const[b]=y._decoded.params,{chainId:w}=b,I=ke(w);if(!e.chains.find(k=>k.id===I))throw new st;const v=f(w);await n().actions.switchChain?.({chainId:v.chain.id,internal:{client:v,config:e,request:y,store:s}}),s.setState(k=>({...k,chainIds:[I,...k.chainIds.filter(j=>j!==I)]}));return}case"wallet_verifySignature":{const[b]=y._decoded.params,{address:w,chainId:I,digest:M,signature:v}=b,k=f(I);return{...await oi(k,{address:w,digest:M,signature:v}),address:w,chainId:N(k.chain.id)}}}},{enabled:m,id:xe(h)})}});function p(){let h=()=>{},m=()=>{};En(s).then(()=>{u().catch(()=>{}),h(),h=s.subscribe(g=>g.accounts,g=>{c.emit("accountsChanged",g.map(we))},{equalityFn:(g,b)=>g.every((w,I)=>w.address===b[I]?.address)}),m(),m=s.subscribe(g=>g.chainIds[0],(g,b)=>{g!==b&&c.emit("chainChanged",N(g))})});const y=fi(d,o);return()=>{h(),m(),y()}}const l=p();return Object.assign(d,{_internal:{destroy:l}})}function fi(t,e){if(!e)return()=>{};if(typeof window>"u"||!window.dispatchEvent)return()=>{};const{icon:n="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIyIiBoZWlnaHQ9IjQyMiIgdmlld0JveD0iMCAwIDQyMiA0MjIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MjIiIGhlaWdodD0iNDIyIiBmaWxsPSJibGFjayIvPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfMV8xNSkiPgo8cGF0aCBkPSJNODEgMjg2LjM2NkM4MSAyODAuODkzIDg1LjQ1MDUgMjc2LjQ1NSA5MC45NDA0IDI3Ni40NTVIMzI5LjUxMUMzMzUuMDAxIDI3Ni40NTUgMzM5LjQ1MiAyODAuODkzIDMzOS40NTIgMjg2LjM2NlYzMDYuMTg4QzMzOS40NTIgMzExLjY2MiAzMzUuMDAxIDMxNi4wOTkgMzI5LjUxMSAzMTYuMDk5SDkwLjk0MDRDODUuNDUwNSAzMTYuMDk5IDgxIDMxMS42NjIgODEgMzA2LjE4OFYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAyMzQuODI4Qzg1LjQ1MDUgMjM0LjgyOCA4MSAyMzkuMjY2IDgxIDI0NC43MzlWMjcxLjUzMUM4My44NDMyIDI2OS42MzMgODcuMjYyMiAyNjguNTI2IDkwLjk0MDQgMjY4LjUyNkgzMjkuNTExQzMzMy4xODggMjY4LjUyNiAzMzYuNjA4IDI2OS42MzMgMzM5LjQ1MiAyNzEuNTMxVjI0NC43MzlDMzM5LjQ1MiAyMzkuMjY2IDMzNS4wMDEgMjM0LjgyOCAzMjkuNTExIDIzNC44MjhIOTAuOTQwNFpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgwLjg5MyAzMzUuMDAxIDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTlDODEgMzExLjY2NCA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2NCAzMzkuNDUyIDMwNi4xOVYyODYuMzY2WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC41Ii8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTAuOTQwNCAxOTMuMjAxQzg1LjQ1MDUgMTkzLjIwMSA4MSAxOTcuNjM4IDgxIDIwMy4xMTJWMjI5LjkwM0M4My44NDMyIDIyOC4wMDYgODcuMjYyMiAyMjYuODk5IDkwLjk0MDQgMjI2Ljg5OUgzMjkuNTExQzMzMy4xODggMjI2Ljg5OSAzMzYuNjA4IDIyOC4wMDYgMzM5LjQ1MiAyMjkuOTAzVjIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNFpNMzM5LjQ1MiAyNDQuNzM5QzMzOS40NTIgMjM5LjI2NSAzMzUuMDAxIDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNDODEuMjE3NSAyNzEuMzg1IDgxLjQzODMgMjcxLjI0NSA4MS42NjI0IDI3MS4xMDlDODMuODMyNSAyNjkuNzk0IDg2LjMwNTQgMjY4LjkyNyA4OC45NTIzIDI2OC42MzVDODkuNjA1MSAyNjguNTYzIDkwLjI2ODQgMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMzAuMTgzIDI2OC41MjYgMzMwLjg0NiAyNjguNTYzIDMzMS40OTggMjY4LjYzNUMzMzQuNDE5IDI2OC45NTcgMzM3LjEyOCAyNjkuOTggMzM5LjQ1MiAyNzEuNTNWMjQ0LjczOVpNMzM5LjQ1MiAyODYuMzY2QzMzOS40NTIgMjgxLjAyMSAzMzUuMjA2IDI3Ni42NjMgMzI5Ljg5MyAyNzYuNDYyQzMyOS43NjcgMjc2LjQ1NyAzMjkuNjQgMjc2LjQ1NSAzMjkuNTExIDI3Ni40NTVIOTAuOTQwNEM4NS40NTA1IDI3Ni40NTUgODEgMjgwLjg5MyA4MSAyODYuMzY2VjMwNi4xODhDODEgMzExLjY2MiA4NS40NTA1IDMxNi4xMDEgOTAuOTQwNCAzMTYuMTAxSDMyOS41MTFDMzM1LjAwMSAzMTYuMTAxIDMzOS40NTIgMzExLjY2MiAzMzkuNDUyIDMwNi4xODhWMjg2LjM2NloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNSIvPgo8cGF0aCBvcGFjaXR5PSIwLjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTguMDE0NiAxMDRDODguNjE3NyAxMDQgODEgMTExLjU5NSA4MSAxMjAuOTY1VjE4OC4yNzZDODMuODQzMiAxODYuMzc5IDg3LjI2MjIgMTg1LjI3MiA5MC45NDA0IDE4NS4yNzJIMzI5LjUxMUMzMzMuMTg4IDE4NS4yNzIgMzM2LjYwOCAxODYuMzc5IDMzOS40NTIgMTg4LjI3NlYxMjAuOTY1QzMzOS40NTIgMTExLjU5NSAzMzEuODMzIDEwNCAzMjIuNDM3IDEwNEg5OC4wMTQ2Wk0zMzkuNDUyIDIwMy4xMTJDMzM5LjQ1MiAxOTcuNjM4IDMzNS4wMDEgMTkzLjIwMSAzMjkuNTExIDE5My4yMDFIOTAuOTQwNEM4NS40NTA1IDE5My4yMDEgODEgMTk3LjYzOCA4MSAyMDMuMTEyVjIyOS45MDNDODEuMjE3NSAyMjkuNzU4IDgxLjQzODMgMjI5LjYxOCA4MS42NjI0IDIyOS40ODJDODMuODMyNSAyMjguMTY3IDg2LjMwNTQgMjI3LjMgODguOTUyMyAyMjcuMDA4Qzg5LjYwNTEgMjI2LjkzNiA5MC4yNjg0IDIyNi44OTkgOTAuOTQwNCAyMjYuODk5SDMyOS41MTFDMzMwLjE4MyAyMjYuODk5IDMzMC44NDYgMjI2LjkzNiAzMzEuNDk4IDIyNy4wMDhDMzM0LjQxOSAyMjcuMzMgMzM3LjEyOCAyMjguMzUyIDMzOS40NTIgMjI5LjkwM1YyMDMuMTEyWk0zMzkuNDUyIDI0NC43MzlDMzM5LjQ1MiAyMzkuMzkzIDMzNS4yMDYgMjM1LjAzNiAzMjkuODkzIDIzNC44MzVDMzI5Ljc2NyAyMzQuODMgMzI5LjY0IDIzNC44MjggMzI5LjUxMSAyMzQuODI4SDkwLjk0MDRDODUuNDUwNSAyMzQuODI4IDgxIDIzOS4yNjUgODEgMjQ0LjczOVYyNzEuNTNMODEuMDcwNyAyNzEuNDgzQzgxLjI2NTMgMjcxLjM1NSA4MS40NjI1IDI3MS4yMyA4MS42NjI0IDI3MS4xMDlDODEuOTA4MyAyNzAuOTYgODIuMTU4MSAyNzAuODE3IDgyLjQxMTcgMjcwLjY3OUM4NC4zOTUzIDI2OS42MDUgODYuNjA1NCAyNjguODk0IDg4Ljk1MjMgMjY4LjYzNUM4OS4wMDUyIDI2OC42MjkgODkuMDU4IDI2OC42MjQgODkuMTExIDI2OC42MThDODkuNzEyNSAyNjguNTU3IDkwLjMyMjggMjY4LjUyNiA5MC45NDA0IDI2OC41MjZIMzI5LjUxMUMzMjkuNzM4IDI2OC41MjYgMzI5Ljk2NSAyNjguNTMgMzMwLjE5MiAyNjguNTM5QzMzMC42MzEgMjY4LjU1NSAzMzEuMDY3IDI2OC41ODcgMzMxLjQ5OCAyNjguNjM1QzMzNC40MTkgMjY4Ljk1NyAzMzcuMTI4IDI2OS45OCAzMzkuNDUyIDI3MS41M1YyNDQuNzM5Wk0zMzkuNDUyIDI4Ni4zNjZDMzM5LjQ1MiAyODEuMDIxIDMzNS4yMDYgMjc2LjY2MyAzMjkuODkzIDI3Ni40NjJMMzI5Ljg2NSAyNzYuNDYxQzMyOS43NDggMjc2LjQ1NyAzMjkuNjI5IDI3Ni40NTUgMzI5LjUxMSAyNzYuNDU1SDkwLjk0MDRDODUuNDUwNSAyNzYuNDU1IDgxIDI4MC44OTMgODEgMjg2LjM2NlYzMDYuMTg4QzgxIDMxMS42NjIgODUuNDUwNSAzMTYuMTAxIDkwLjk0MDQgMzE2LjEwMUgzMjkuNTExQzMzNS4wMDEgMzE2LjEwMSAzMzkuNDUyIDMxMS42NjIgMzM5LjQ1MiAzMDYuMTg4VjI4Ni4zNjZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMjY5Ljg2OCAxMzEuNzUyQzI2OS44NjggMTI2LjI3OCAyNzQuMzE4IDEyMS44NCAyNzkuODA4IDEyMS44NEgzMTEuNjE4QzMxNy4xMDggMTIxLjg0IDMyMS41NTggMTI2LjI3OCAzMjEuNTU4IDEzMS43NTJWMTYxLjQ4NUMzMjEuNTU4IDE2Ni45NTkgMzE3LjEwOCAxNzEuMzk2IDMxMS42MTggMTcxLjM5NkgyNzkuODA4QzI3NC4zMTggMTcxLjM5NiAyNjkuODY4IDE2Ni45NTkgMjY5Ljg2OCAxNjEuNDg1VjEzMS43NTJaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzFfMTUiPgo8cmVjdCB3aWR0aD0iMjU5IiBoZWlnaHQ9IjIxMyIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgxIDEwNCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",name:r="Porto",rdns:s="xyz.ithaca.porto"}=typeof e=="object"?e:{};return Ss({info:{icon:n,name:r,rdns:s,uuid:Gt()},provider:t})}function ge(t){return t.map(e=>{if(e.role==="admin")try{return z(Qt.Key,{id:e.id??e.publicKey,publicKey:e.publicKey,type:e.type,...e.type==="webauthn-p256"?{credentialId:e.privateKey?.credential?.id,privateKey:{credential:{id:e.privateKey?.credential?.id},rpId:e.privateKey?.rpId}}:{}})}catch{return}}).filter(Boolean)}function vt(t,{address:e}){return t.map(n=>{if(n.chainId&&n.role==="session"&&!(n.expiry>0&&n.expiry<BigInt(Math.floor(Date.now()/1e3))))try{return z(Ut,yr(n,{address:e}))}catch{return}}).filter(Boolean)}function we(t){return Ns(t.address)}function mr(t){return{...t,setup:t.setup??(()=>()=>{})}}async function Kt(t){const{account:e,calls:n,permissionsId:r}=t;if(typeof r<"u"){if(r===null)return;const u=e.keys?.find(f=>f.publicKey===r&&f.privateKey);if(!u)throw new Error(`permission (id: ${r}) does not exist.`);return u}const s=e.keys?.find(u=>!u.privateKey||u.role!=="session"||u.expiry<BigInt(Math.floor(Date.now()/1e3))?!1:!!n.every(i=>u.permissions?.calls?.some(a=>{if(a.to&&a.to!==i.to)return!1;if(a.signature){if(!i.data)return!1;const c=Ee(i.data,0,4);if(Ft(a.signature))return a.signature===c;if(zn(a.signature)!==c)return!1}return!0}))),o=e.keys?.find(u=>u.role==="admin"&&u.privateKey);return s??o}const Be=_s;function We(t){const{expiry:e,feeToken:n,permissions:r,publicKey:s,type:o}=t;return{expiry:e,feeToken:n??null,key:{publicKey:s,type:o},permissions:r??{}}}async function ne(t,e={}){if(!t)return;const n=e.chainId??t.chainId,r=t.expiry??0,s=t.feeToken,o=pr(t,{feeTokens:e.feeTokens}),u={chainId:n,expiry:r,feeToken:s,permissions:o,role:"session"};if(t?.key)return Y({...u,publicKey:t.key.publicKey,type:t.key.type??"secp256k1"});if(typeof globalThis.crypto?.subtle?.generateKey=="function")try{return await Ko(u)}catch(i){if(!pi(i))throw i}return Uo(u)}function pi(t){if(!(t instanceof Error))return!1;const e=t.message?.toLowerCase()??"";return t.name==="TypeError"||t.name==="ReferenceError"||e.includes("subtle")||e.includes("generatekey")}async function An(t){const{address:e,authUrl:n,message:r,signature:s,publicKey:o}=t,{chainId:u}=za(r);return await fetch(n.verify,{body:JSON.stringify({address:e,chainId:u,message:r,signature:s,walletAddress:e,...o&&{publicKey:o}}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST"}).then(f=>f.json())}async function kt(t,e,n){const{chainId:r=t.chain?.id,domain:s,uri:o,resources:u,version:f="1"}=e,{address:i}=n,a=e.authUrl?gr(e.authUrl):void 0;if(!r)throw new Error("`chainId` is required.");if(!s)throw new Error("`domain` is required.");if(!e.nonce&&!a?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");if(!o)throw new Error("`uri` is required.");const c=await(async()=>{if(e.nonce)return e.nonce;if(!a?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");const l=await(await fetch(a.nonce,{body:JSON.stringify({address:i,chainId:r,walletAddress:i}),headers:{"Content-Type":"application/json"},method:"POST"})).json().catch(()=>{});if(!l?.nonce)throw new Error("`nonce` or `authUrl.nonce` is required.");return l.nonce})();return Oa({...e,address:n.address,chainId:r,domain:s,nonce:c,resources:u,uri:o,version:f})}function gr(t,e=""){if(!t)return;const n=(()=>{if(typeof t=="string"){const r=t.replace(/\/$/,"");return{logout:r+"/logout",nonce:r+"/nonce",verify:r+"/verify"}}return t})();return{logout:jt(n.logout,e),nonce:jt(n.nonce,e),verify:jt(n.verify,e)}}function jt(t,e){return!e||!t.startsWith("/")?t:e+t}async function xn(t,e){const{account:n=t.account}=e,r=n?$(n):void 0;if(!r)throw new Error("account is required.");const{domain:{name:s,version:o}}=await qs(t,{address:r.address});if(!t.chain)throw new Error("client.chain is required");return{chainId:t.chain.id,name:s,verifyingContract:r.address,version:o}}async function Dn(t,e){const{account:n=t.account,chainIds:r}=e,s=n?$(n):void 0;if(!s)throw new Error("account is required.");const o=await Jo(t,{address:s.address,chainIds:r});return Object.entries(o).flatMap(([u,f])=>f.map(i=>$o(i,{chainId:Number(u)})))}async function je(t,e){const{account:n=t.account,calls:r,chain:s=t.chain,feePayer:o,merchantUrl:u,nonce:f,preCalls:i,requiredFunds:a,revokeKeys:c}=e,d=n?$(n):void 0,p=e.key??(d?yt(d,{role:"admin"}):void 0),l=e.authorizeKeys?.some(O=>O.role==="session"),{contracts:h,fees:{tokens:m}}=await Ue(t,{chainId:s?.id}),y=l?h.orchestrator.address:void 0,g=(e.authorizeKeys??[]).map(O=>ct(O,{feeTokens:m,orchestrator:y})),b=e.feeToken?e.feeToken:p?.permissions?.spend?.[0]?.token,w=typeof i=="boolean"?i:!1,I=typeof i=="object"?i.map(({context:O,signature:T})=>({...O.preCall,signature:T})):void 0,M={address:d?.address,calls:r??[],capabilities:{authorizeKeys:g,meta:{feePayer:o,feeToken:b,nonce:f},preCall:w,preCalls:I,requiredFunds:a,revokeKeys:c?.map(O=>({hash:O.hash}))},chain:s,key:p?ct(p,{feeTokens:m}):void 0},v=await(async()=>{if(u){const O=Un({chain:t.chain,transport:pt(u)});return await bt(O,M).catch(T=>(console.error(T),bt(t,M)))}return await bt(t,M)})(),{capabilities:k,context:j,digest:E,signature:A,typedData:D}=v;if(u&&!await ai(t,{response:v._raw,signature:A}))throw new Error(`cannot verify integrity of \`wallet_prepareCalls\` response from ${u}`);return{capabilities:{...k,quote:j.quote},context:j,digest:E,key:p,typedData:D}}async function wr(t,e){const{address:n,authorizeKeys:r,chain:s=t.chain}=e;if(!s)throw new Error("chain is required.");const{contracts:o,fees:{tokens:u}}=await Ue(t,{chainId:s.id}),f=e.delegation??o.accountProxy.address,a=r.some(g=>g.role==="session")?o.orchestrator.address:void 0,c=r.map(g=>{const b=g.role==="session"?g.permissions:{};return ct({...g,permissions:b},{feeTokens:u,orchestrator:a})}),{capabilities:d,chainId:p,context:l,digests:h,typedData:m}=await ei(t,{address:n,authorizeKeys:c,chain:s,delegation:f}),y=$({address:n,keys:r});return{capabilities:d,chainId:p,context:{...l,account:y},digests:h,typedData:m}}async function Qe(t,e){const{account:n=t.account,chain:r=t.chain,webAuthn:s}=e;if(!r)throw new Error("`chain` is required.");const o=n?$(n):void 0;if(!o)throw new Error("`account` is required.");const u=e.key??yt(o,e);if(!u&&!o.sign)throw new Error("`key` or `account` with `sign` is required");const f=await Promise.all((e.preCalls??[]).map(async p=>{if(p.signature)return p;const{authorizeKeys:l,key:h,calls:m,revokeKeys:y}=p,{context:g,digest:b}=await je(t,{account:o,authorizeKeys:l,calls:m,chain:r,feeToken:e.feeToken,key:h,preCalls:!0,revokeKeys:y}),w=await ae(h,{address:null,payload:b,webAuthn:s});return{context:g,signature:w}})),{capabilities:i,context:a,digest:c}=await je(t,{...e,account:o,chain:r,key:u,preCalls:f}),d=await(async()=>u?await ae(u,{address:null,payload:c,webAuthn:s,wrap:!1}):await o.sign({hash:c}))();return await Ge(t,{capabilities:i.feeSignature?{feeSignature:i.feeSignature}:void 0,context:a,key:u,signature:d})}async function Ge(t,e){const{capabilities:n,context:r,key:s,signature:o}=e;return await ti(t,{capabilities:n,context:r,key:s?ct(s):void 0,signature:o})}async function Tn(t,e){const{email:n,walletAddress:r}=e;return await ni(t,{email:n,walletAddress:r})}async function Lt(t,e){if(e.account){const{account:o}=e,u=[...o.keys??[],...e.authorizeKeys??[]].filter((c,d,p)=>p.findIndex(l=>l.id===c.id)===d),{digests:f,...i}=await wr(t,{...e,address:o.address,authorizeKeys:u}),a={auth:await o.sign({hash:f.auth}),exec:await o.sign({hash:f.exec})};return await Lt(t,{...i,signatures:a})}const{context:n,signatures:r}=e,s=$(n.account);return await ri(t,{context:n,signatures:r}),s}async function hi(t,e){const{chainId:n,email:r,signature:s,token:o,walletAddress:u}=e;return await si(t,{chainId:n,email:r,signature:s,token:o,walletAddress:u})}async function be(t,e){const{address:n}=e,{authorization:r,data:s,to:o}=await Vo(t,{address:n});return Rs({authorization:{...r,nonce:BigInt(r.nonce),r:BigInt(r.r),s:BigInt(r.s)},data:s,signature:e.signature,to:o})}function On(t,e){const{tokens:n}=e,r=n.filter(s=>s.interop);return t.map(s=>{if(s.address)return s;const o=r.find(u=>u.symbol===s.symbol);if(!o)throw new Error(`interop token not found: ${s.symbol}`);return{address:o.address,value:Qn(s.value,o.decimals)}})}async function X(t,e){const{chain:n=t.chain}=e??{};return await Ue(t,{chainId:n?.id}).then(s=>s.fees.tokens)}async function $t(t,e){const{addressOrSymbol:n}=e;return(await X(t,e)).find($t.predicate(n))}(function(t){function e(n){return r=>n?dt(n)?P(r.address,n):n==="native"?r.address===De:n===r.symbol:!1}t.predicate=e})($t||($t={}));async function le(t,e){const{chain:n=t.chain,store:r}=e??{},s=r?.getState()??{},o=e?.addressOrSymbol??s.feeToken;return(await X(t,{chain:n}).then(i=>i.filter(a=>a.feeToken)))?.find(i=>o?o==="native"&&i.address===De||dt(o)&&P(i.address,o)?!0:o===i.symbol:!1)}function br(t={}){const e=t,{mock:n,multichain:r=!0,webAuthn:s}=e;let o,u;const f=(()=>{if(e.keystoreHost!=="self"&&!(typeof window<"u"&&window.location?.hostname==="localhost"))return e.keystoreHost})();return mr({actions:{async addFunds(){throw new qe},async createAccount(i){const{admins:a,email:c,label:d,permissions:p,internal:l,signInWithEthereum:h}=i,{client:m}=l,y=Wo(Ks()),g=await X(m),b=n?Mn():await In({createFn:s?.createFn,label:d||`${y.address.slice(0,8)}${y.address.slice(-6)}`,rpId:f,userId:At(y.address)}),w=await ne(p,{chainId:m.chain.id,feeTokens:g}),I=a?.map(k=>Y(k)),M=await Lt(m,{account:y,authorizeKeys:[b,...I??[],...w?[w]:[]]});o=y.address,c&&d&&await Tn(m,{email:d,walletAddress:M.address});const v=await(async()=>{if(!h)return;const k=await kt(m,h,{address:M.address}),j=await me(y,{payload:Ye(G(k))}),E=await be(m,{address:M.address,signature:j});return{message:k,signature:E}})();return{account:{...M,signInWithEthereum:v}}},async getAccountVersion(i){const{address:a,internal:c}=i,{client:d}=c,{contracts:p}=await Ue(d),{accountImplementation:l}=p,h=await xn(d,{account:$(l)}).then(y=>y.version),m=await xn(d,{account:a}).then(y=>y.version).catch(()=>h);if(!m||!h)throw new Error("version not found.");return{current:m,latest:h}},async getAssets(i){const{account:a,chainFilter:c,assetFilter:d,assetTypeFilter:p,internal:l}=i,{client:h}=l;return await Zo(h,{account:a,assetFilter:d,assetTypeFilter:p,chainFilter:c})},async getCallsStatus(i){const{id:a,internal:c}=i,{client:d}=c,p=await Go(d,{id:a});return{atomic:!0,chainId:N(d.chain.id),id:a,receipts:p.receipts?.map(l=>({blockHash:l.blockHash,blockNumber:N(l.blockNumber),gasUsed:N(l.gasUsed),logs:l.logs,status:l.status,transactionHash:l.transactionHash})),status:p.status,version:"1.0"}},async getCapabilities(i){const{chainIds:a,internal:c}=i,{client:d}=c,p={atomic:{status:"supported"},atomicBatch:{supported:!0},feeToken:{supported:!0,tokens:[]},merchant:{supported:!0},permissions:{supported:!0},requiredFunds:{supported:!!r,tokens:[]}},l=await Ue(d,{chainIds:a?a.map(h=>ke(h)):"all",raw:!0});return Object.entries(l).reduce((h,[m,y])=>({...h,[m]:{...p,...y,feeToken:{supported:!0,tokens:y.fees.tokens},requiredFunds:{supported:!!r,tokens:r?y.fees.tokens.filter(g=>g.interop):[]}}}),{})},async getKeys(i){const{account:a,chainIds:c,internal:d}=i,{client:p}=d,l=await Dn(p,{account:a,chainIds:c});return rr([...l,...a.keys??[]],h=>h.publicKey)},async grantAdmin(i){const{account:a,internal:c}=i,{client:d}=c,p=Y(i.key,{chainId:d.chain.id}),l=await le(d,{addressOrSymbol:i.feeToken,store:c.store}),{id:h}=await Qe(d,{account:a,authorizeKeys:[p],feeToken:l?.address,webAuthn:s});return await Ie(d,{id:h,pollingInterval:500}),{key:p}},async grantPermissions(i){const{account:a,internal:c,permissions:d}=i,{client:p}=c,l=await X(p),h=await ne(d,{chainId:p.chain.id,feeTokens:l});if(!h)throw new Error("key to authorize not found.");const m=a.keys?.find(w=>w.role==="admin"&&w.privateKey);if(!m)throw new Error("admin key not found.");const{context:y,digest:g}=await je(p,{account:a,authorizeKeys:[h],key:m,preCalls:!0}),b=await ae(m,{address:null,payload:g});return await Ge(p,{context:y,key:m,signature:b}),{key:h}},async loadAccounts(i){const{internal:a,permissions:c,signInWithEthereum:d}=i,{client:p}=a,l=await X(p),h=await ne(c,{chainId:p.chain.id,feeTokens:l}),{digest:m,digestType:y,message:g}=await(async()=>{if(d&&i.address){const A=await kt(p,d,{address:i.address});return{context:void 0,digest:Ye(G(A)),digestType:"siwe",message:A}}return{context:void 0,digest:"0x",message:void 0}})(),{address:b,credentialId:w,webAuthnSignature:I}=await(async()=>{if(n){if(!o)throw new Error("address_internal not found.");return{address:o,credentialId:void 0}}if(i.address&&i.key)return{address:i.address,credentialId:i.key.credentialId};const A=await Xn({challenge:m,getFn:s?.getFn,rpId:f}),D=A.raw.response,O=Bt(new Uint8Array(D.userHandle)),T=A.raw.id;return{address:O,credentialId:T,webAuthnSignature:A}})(),M=await Dn(p,{account:b,chainIds:[p.chain.id]}),v=$({address:b,keys:[...M,...h?[h]:[]].map((A,D)=>D===0&&A.type==="webauthn-p256"?dr({...A,credential:{id:w,publicKey:qn(A.publicKey)},id:b,rpId:f}):A)}),k=yt(v,{role:"admin"}),j=await(async()=>{if(m!=="0x")return I?hr(qt(I),{keyType:"webauthn-p256",publicKey:k.publicKey}):await ae(k,{address:v.address,payload:m})})();if(h){const{context:A,digest:D}=await je(p,{account:v,authorizeKeys:[h],preCalls:!0}),O=await ae(k,{address:null,payload:D});await Ge(p,{context:A,key:k,signature:O})}const E=await(async()=>{if(d){if(y==="siwe"&&g&&j){const A=await be(p,{address:v.address,signature:j});return{message:g,signature:A}}{const A=await kt(p,d,{address:v.address}),D=await me(v,{payload:Ye(G(A)),role:"admin"}),O=await be(p,{address:v.address,signature:D});return{message:A,signature:O}}}})();return{accounts:[{...v,signInWithEthereum:E}]}},async prepareCalls(i){const{account:a,calls:c,internal:d,merchantUrl:p}=i,{client:l}=d,h=i.key??await Kt({account:a,calls:c});if(!h)throw new Error("cannot find authorized key to sign with.");const[m,y]=await Promise.all([X(l),le(l,{addressOrSymbol:i.feeToken,store:d.store})]),g=On(i.requiredFunds??[],{tokens:m}),{capabilities:b,context:w,digest:I,typedData:M}=await je(l,{account:a,calls:c,feeToken:y?.address,key:h,merchantUrl:p,requiredFunds:r?g:void 0}),v=w.quote?.quotes??[],k=v[v.length-1];return{account:a,capabilities:{...b,quote:w.quote},chainId:l.chain.id,context:{...w,account:a,calls:c,nonce:k?.intent.nonce},digest:I,key:h,typedData:M}},async prepareUpgradeAccount(i){const{address:a,email:c,label:d,internal:p,permissions:l}=i,{client:h}=p,[m,y]=await Promise.all([X(h),le(h,{store:p.store})]),g=n?Mn():await In({createFn:s?.createFn,label:d||`${a.slice(0,8)}${a.slice(-6)}`,rpId:f,userId:At(a)}),b=await ne(l,{chainId:h.chain.id,feeTokens:m}),{context:w,digests:I}=await wr(h,{address:a,authorizeKeys:[g,...b?[b]:[]],feeToken:y?.address});return c&&(u=d),{context:w,digests:I}},async revokeAdmin(i){const{account:a,id:c,internal:d}=i,{client:p}=d,l=a.keys?.find(h=>h.id===c);if(l){if(l.type==="webauthn-p256"&&a.keys?.filter(h=>h.type==="webauthn-p256").length===1)throw new Error("revoke the only WebAuthn key left.");try{const h=await le(p,{addressOrSymbol:i.feeToken,store:d.store}),{id:m}=await Qe(p,{account:a,feeToken:h?.address,revokeKeys:[l],webAuthn:s});await Ie(p,{id:m})}catch(h){const m=h;if(m.name==="Rpc.ExecutionError"&&m.abiError?.name==="KeyDoesNotExist")return;throw h}}},async revokePermissions(i){const{account:a,id:c,internal:d}=i,{client:p}=d,l=a.keys?.find(h=>h.id===c);if(l){if(l.role==="admin")throw new Error("cannot revoke admins.");try{const h=await le(p,{addressOrSymbol:i.feeToken,store:d.store}),{id:m}=await Qe(p,{account:a,feeToken:h?.address,revokeKeys:[l],webAuthn:s});await Ie(p,{id:m})}catch(h){const m=h;if(m.name==="Rpc.ExecutionError"&&m.abiError?.name==="KeyDoesNotExist")return;throw h}}},async sendCalls(i){const{account:a,asTxHash:c,calls:d,chainId:p,internal:l,merchantUrl:h}=i,{client:m}=l,y=await Kt({account:a,calls:d,permissionsId:i.permissionsId}),[g,b]=await Promise.all([X(m),le(m,{addressOrSymbol:i.feeToken,store:l.store})]),w=On(i.requiredFunds??[],{tokens:g}),I=await Qe(m,{account:a,calls:d,feeToken:b?.address,key:y,merchantUrl:h,requiredFunds:r?w:void 0,webAuthn:s,...p?{chain:{id:p}}:{}});if(c){const{id:M,receipts:v,status:k}=await Ie(m,{id:I.id,pollingInterval:500});if(!v?.[0])throw k==="success"?new Re({message:"Call bundle with id: "+M+" not found."}):new oe({message:"Transaction failed under call bundle id: "+M+"."});return{id:v[0].transactionHash}}return I},async sendPreparedCalls(i){const{context:a,key:c,internal:d,signature:p}=i,{client:l}=d,{id:h}=await Ge(l,{context:a,key:c,signature:p});return h},async signPersonalMessage(i){const{account:a,data:c,internal:d}=i,{client:p}=d,l=a.keys?.find(m=>m.role==="admin"&&m.privateKey);if(!l)throw new Error("cannot find admin key to sign with.");const h=await me(a,{key:l,payload:Ye(c),webAuthn:s});return be(p,{address:a.address,signature:h})},async signTypedData(i){const{account:a,internal:c}=i,{client:d}=c,p=a.keys?.find(y=>y.role==="admin"&&y.privateKey);if(!p)throw new Error("cannot find admin key to sign with.");const l=Us(i.data),h=l.domain?.name==="Orchestrator",m=await me(a,{key:p,payload:Zt(l),replaySafe:!h,webAuthn:s});return h?m:be(d,{address:a.address,signature:m})},async upgradeAccount(i){const{account:a,context:c,internal:d,signatures:p}=i,{client:l}=d;return await Lt(l,{context:c,signatures:p}),u&&await Tn(l,{email:u,walletAddress:a.address}),{account:a}},async verifyEmail(i){const{account:a,chainId:c,email:d,token:p,internal:l,walletAddress:h}=i,{client:m}=l,y=a.keys?.find(b=>b.role==="admin"&&b.privateKey);if(!y)throw new Error("cannot find admin key to sign with.");const g=await me(a,{key:y,payload:L(G(`${d}${p}`)),webAuthn:s});return await hi(m,{chainId:c,email:d,signature:g,token:p,walletAddress:h})}},config:t,name:"rpc"})}function yi(t={}){const{fallback:e=br(),host:n=ar.prod,renderer:r=To(),theme:s,themeController:o}=t,u=new Set,f=Ma();function i(a){return Bn({async request(c){const d=f.prepare(c);return a.setState(p=>{const l=p.accounts[0],h=l?.keys?.find(m=>m.role==="admin"&&m.type==="webauthn-p256");return{...p,requestQueue:[...p.requestQueue,{account:l?{address:l.address,key:h?{credentialId:h?.credentialId,publicKey:h.publicKey}:void 0}:void 0,request:d,status:"pending"}]}}),new Promise((p,l)=>{const h=m=>{const y=m.find(g=>g.request.id===d.id);if(!y&&m.length===0){u.delete(h),l(new pe);return}y&&(y.status!=="success"&&y.status!=="error"||(u.delete(h),y.status==="success"?p(y.result):l(Wn(y.error)),a.setState(g=>({...g,requestQueue:g.requestQueue.filter(b=>b.request.id!==d.id)}))))};u.add(h)})}},{})}return mr({actions:{async addFunds(a){const{internal:c}=a,{request:d,store:p}=c;if(d.method!=="wallet_addFunds")throw new Error("Cannot add funds for method: "+d.method);return await i(p).request(d)},async createAccount(a){const{internal:c}=a,{client:d,config:p,request:l,store:h}=c,{storage:m}=p,y=i(h);return{account:await(async()=>{if(l.method==="wallet_connect"){const[{capabilities:b,chainIds:w}]=l._decoded.params??[{}],I=Et(b?.signInWithEthereum?.authUrl??p.authUrl,{storage:m}),M=l.params?.[0]?.capabilities?.signInWithEthereum,v=await ne(b?.grantPermissions,{chainId:d.chain.id}),k=v?z(Be,We(v)):void 0,{accounts:j}=await y.request({...l,params:[{capabilities:{...l.params?.[0]?.capabilities,grantPermissions:k,signInWithEthereum:I||M?{...M,authUrl:I}:void 0},chainIds:w?.map(T=>N(T))}]}),[E]=j;if(!E)throw new Error("no account found.");const A=E.capabilities?.admins?.map(T=>Y(T,{chainId:d.chain.id})).filter(Boolean),D=E.capabilities?.permissions?.map(T=>{try{const C=vn(q(Ut,T));return C.id===v?.id?{...C,...v,permissions:C.permissions}:C}catch{return}}).filter(Boolean),O=await(async()=>{if(!E.capabilities?.signInWithEthereum)return;const{message:T,signature:C}=E.capabilities.signInWithEthereum;if(!I)return{message:T,signature:C};const{token:x}=await An({address:E.address,authUrl:I,message:T,publicKey:E.capabilities?.admins?.[0]?.publicKey,signature:C});return{message:T,signature:C,token:x}})();return{...$({address:E.address,keys:[...A??[],...D??[]]}),signInWithEthereum:O}}throw new Error(`Account creation not supported on method: ${l.method}`)})()}},async disconnect(a){const{internal:c}=a,{config:d}=c,{storage:p}=d,l=await p.getItem("porto.authUrl")||void 0,h=Et(d.authUrl??l,{storage:p});h&&await fetch(h.logout,{credentials:"include",method:"POST"}).catch(()=>{})},async getAccountVersion(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_getAccountVersion")throw new Error("Cannot get version for method: "+p.method);return r.supportsHeadless?await i(d).request(p):e.actions.getAccountVersion(a)},async getAssets(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_getAssets")throw new Error("Cannot get assets for method: "+p.method);if(!r.supportsHeadless)return e.actions.getAssets(a);const h=await i(d).request(p);return q(Ht.Response,h)},async getCallsStatus(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_getCallsStatus")throw new Error("Cannot get status for method: "+p.method);return r.supportsHeadless?await i(d).request(p):e.actions.getCallsStatus(a)},async getCapabilities(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_getCapabilities")throw new Error("Cannot get capabilities for method: "+p.method);return r.supportsHeadless?await i(d).request(p):e.actions.getCapabilities(a)},async getKeys(a){const{account:c,chainIds:d,internal:p}=a,{store:l}=p,h=await(async()=>{if(!r.supportsHeadless)return e.actions.getKeys(a);const y=await i(l).request({method:"wallet_getKeys",params:[z(tt.Parameters,{address:c.address,chainIds:d})]});return q(tt.Response,y)})();return rr([...h,...c.keys??[]],m=>m.publicKey)},async grantAdmin(a){const{internal:c}=a,{request:d,store:p}=c;if(d.method!=="wallet_grantAdmin")throw new Error("Cannot authorize admin for method: "+d.method);const[l]=d._decoded.params,h=Y(l.key);if(!h)throw new Error("no key found.");const m=await He(c,a);return await i(p).request({method:"wallet_grantAdmin",params:[{...d.params?.[0],capabilities:{...d.params?.[0]?.capabilities,feeToken:m}}]}),{key:h}},async grantPermissions(a){const{internal:c}=a,{client:d,request:p,store:l}=c;if(p.method!=="wallet_grantPermissions")throw new Error("Cannot grant permissions for method: "+p.method);const[{address:h,...m}]=p._decoded.params,y=await ne(m,{chainId:d.chain.id});if(!y)throw new Error("no key found.");const g=z(Be,We(y));return await i(l).request({method:"wallet_grantPermissions",params:[g]}),{key:y}},async loadAccounts(a){const{internal:c}=a,{client:d,config:p,store:l}=c,{storage:h}=p,m=i(l),y=c.request;if(y.method!=="wallet_connect"&&y.method!=="eth_requestAccounts")throw new Error("Cannot load accounts for method: "+y.method);return{accounts:await(async()=>{const[b]=y._decoded.params??[],{capabilities:w}=b??{},I=Et(w?.signInWithEthereum?.authUrl??p.authUrl,{storage:h}),M=y.params?.[0]?.capabilities?.signInWithEthereum,v=await ne(w?.grantPermissions,{chainId:d.chain.id}),k=v?z(Be,We(v)):void 0,{accounts:j}=await m.request({method:"wallet_connect",params:[{...y.params?.[0],capabilities:{...y.params?.[0]?.capabilities,grantPermissions:k,signInWithEthereum:I||M?{...M,authUrl:I}:void 0}}]});return Promise.all(j.map(async E=>{const A=E.capabilities?.admins?.map(T=>Y(T)).filter(Boolean),D=E.capabilities?.permissions?.map(T=>{try{const C=vn(q(Ut,T));return C.id===v?.id?{...C,...v,permissions:C.permissions}:C}catch{return}}).filter(Boolean),O=await(async()=>{if(!E.capabilities?.signInWithEthereum)return;const{message:T,signature:C}=E.capabilities.signInWithEthereum;if(!I)return{message:T,signature:C};const{token:x}=await An({address:E.address,authUrl:I,message:T,publicKey:E.capabilities?.admins?.[0]?.publicKey,signature:C});return{message:T,signature:C,token:x}})();return{...$({address:E.address,keys:[...A??[],...D??[]]}),signInWithEthereum:O}}))})()}},async prepareCalls(a){const{account:c,internal:d}=a,{store:p,request:l}=d;if(l.method!=="wallet_prepareCalls")throw new Error("Cannot prepare calls for method: "+l.method);if(!r.supportsHeadless)return e.actions.prepareCalls(a);const h=await He(d,a),m=i(p),y=q(nt.Response,await m.request({...l,params:[{...l.params?.[0],capabilities:{...l.params?.[0]?.capabilities,feeToken:h}}]}));return{account:c,chainId:Number(y.chainId),context:y.context,digest:y.digest,key:y.key,typedData:y.typedData}},async prepareUpgradeAccount(a){const{internal:c}=a,{client:d,store:p,request:l}=c;if(l.method!=="wallet_prepareUpgradeAccount")throw new Error("Cannot prepare upgrade for method: "+l.method);if(!r.supportsHeadless)return e.actions.prepareUpgradeAccount(a);const[{capabilities:h}]=l._decoded.params??[{}],m=await ne(h?.grantPermissions,{chainId:d.chain.id}),y=m?z(Be,We(m)):void 0,g=i(p),{context:b,digests:w}=await g.request({...l,params:[{...l.params?.[0],capabilities:{...l.params?.[0]?.capabilities,grantPermissions:y}}]}),I=b.account.keys?.map(M=>M.id===m?.id?{...M,...m}:M);return{context:{...b,account:{...b.account,keys:I}},digests:w}},async revokeAdmin(a){const{account:c,id:d,internal:p}=a,{store:l,request:h}=p;if(h.method!=="wallet_revokeAdmin")throw new Error("Cannot revoke admin for method: "+h.method);const m=c.keys?.find(b=>b.id===d);if(!m)return;if(m.type==="webauthn-p256"&&c.keys?.filter(b=>b.type==="webauthn-p256").length===1)throw new Error("revoke the only WebAuthn key left.");const y=await He(p,a);return await i(l).request({...h,params:[{...h.params?.[0],capabilities:{...h.params?.[0]?.capabilities,feeToken:y}}]})},async revokePermissions(a){const{account:c,id:d,internal:p}=a,{store:l,request:h}=p;if(h.method!=="wallet_revokePermissions")throw new Error("Cannot revoke permissions for method: "+h.method);const m=c.keys?.find(g=>g.id===d);if(!m)return;if(m.role==="admin")throw new Error("cannot revoke permissions.");return await i(l).request(h)},async sendCalls(a){const{account:c,asTxHash:d,calls:p,chainId:l,internal:h,merchantUrl:m,requiredFunds:y}=a,{client:g,store:b,request:w}=h,I=i(b),M=await He(h,a),v=await Kt({account:c,calls:p,permissionsId:a.permissionsId});if(v&&v.role==="session"){if(!r.supportsHeadless)return e.actions.sendCalls(a);try{const k=await I.request(z(nt.Request,{method:"wallet_prepareCalls",params:[{calls:p,capabilities:{...w._decoded.method==="wallet_sendCalls"?w._decoded.params?.[0]?.capabilities:void 0,feeToken:M,merchantUrl:m,requiredFunds:y},chainId:l,from:c.address,key:v}]})),j=k.capabilities?.quote?.quotes??[];if(j.some((T,C)=>C===j.length-1&&j.length>1?!1:Wt(T.feeTokenDeficit)>0n))throw new Error("insufficient funds");const A=await ae(v,{address:null,payload:k.digest,wrap:!1}),O=(await I.request({method:"wallet_sendPreparedCalls",params:[{...k,signature:A}]}))[0];if(!O)throw new Error("id not found");if(d){const{id:T,receipts:C,status:x}=await Ie(g,{id:O.id,pollingInterval:500});if(!C?.[0])throw x==="success"?new Re({message:"Call bundle with id: "+T+" not found."}):new oe({message:"Transaction failed under call bundle id: "+T+"."});return{id:C[0].transactionHash}}return O}catch{}}if(w.method==="eth_sendTransaction")return{id:await I.request({...w,params:[{...w.params?.[0],capabilities:{feeToken:M,merchantUrl:m},...l?{chainId:N(l)}:{}}]})};if(w.method==="wallet_sendCalls")return await I.request({method:"wallet_sendCalls",params:[{...w.params?.[0],capabilities:{...w.params?.[0]?.capabilities,feeToken:M,merchantUrl:m},...l?{chainId:N(l)}:{}}]});throw new Error("Cannot execute for method: "+w.method)},async sendPreparedCalls(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_sendPreparedCalls")throw new Error("Cannot send prepared calls for method: "+p.method);if(!r.supportsHeadless)return e.actions.sendPreparedCalls(a);const m=(await i(d).request(p))[0]?.id;if(!m)throw new Error("id not found");return m},async signPersonalMessage(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="personal_sign")throw new Error("Cannot sign personal message for method: "+p.method);return await i(d).request(p)},async signTypedData(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="eth_signTypedData_v4")throw new Error("Cannot sign typed data for method: "+p.method);return await i(d).request(p)},async switchChain(a){const{internal:c}=a,{store:d,request:p}=c;if(p.method!=="wallet_switchEthereumChain")throw new Error("Cannot switch chain for method: "+p.method);return r.supportsHeadless?await i(d).request(p):void 0},async upgradeAccount(a){const{account:c,internal:d}=a,{store:p,request:l}=d;if(l.method!=="wallet_upgradeAccount")throw new Error("Cannot upgrade account for method: "+l.method);return await i(p).request(l),{account:c}},async verifyEmail(a){const{internal:c}=a,{request:d,store:p}=c;if(d.method!=="account_verifyEmail")throw new Error("Cannot verify email for method: "+d.method);return await i(p).request(d)}},config:t,name:"dialog",setup(a){const{internal:c}=a,{store:d}=c,p=r.setup({host:n,internal:c,theme:s,themeController:o}),l=d.subscribe(h=>h.requestQueue,h=>{for(const y of u)y(h);const m=h.map(y=>y.status==="pending"?y:void 0).filter(Boolean);p.syncRequests(m).catch(()=>{}),m.length===0&&p.close()});return()=>{l(),p.destroy()}}})}async function He(t,e){const{config:{feeToken:n}}=t,{feeToken:r}=e??{};return r??n}function Et(t,{storage:e}){if(!t)return;const n=gr(t,typeof window<"u"?window.location.origin:void 0);return n&&e.setItem("porto.authUrl",n),n}function mi(){const t=typeof indexedDB<"u"?na("porto","store"):void 0;return{async getItem(e){const n=await aa(e,t);return n===null?null:n},async removeItem(e){await sa(e,t)},async setItem(e,n){await ra(e,he(n),t)},sizeLimit:1024*1024*50}}function gi(){const t=new Map;return{getItem(e){return t.get(e)??null},removeItem(e){t.delete(e)},setItem(e,n){t.set(e,n)},sizeLimit:Number.POSITIVE_INFINITY}}const Cn=typeof window<"u"&&typeof document<"u",re={announceProvider:!0,chains:vo,mode:Cn?yi({host:ar.prod}):br(),relay:pt(ci.prod.http),storage:Cn&&typeof indexedDB<"u"?mi():gi(),storageKey:"porto.store"};function wi(t={}){const e=t.chains??re.chains,n=Object.fromEntries(e.map(a=>[a.id,t.transports?.[a.id]??pt()])),r={announceProvider:t.announceProvider??re.announceProvider,authUrl:t.authUrl,chains:e,feeToken:t.feeToken,merchantUrl:t.merchantUrl,mode:t.mode??re.mode,relay:t.relay??re.relay,storage:t.storage??re.storage,storageKey:t.storageKey??re.storageKey,transports:n},s=Ls($s(Fs(Ys(a=>({accounts:[],chainIds:r.chains.map(c=>c.id),feeToken:r.feeToken,requestQueue:[]}),{merge(a,c){const d=a,p=r.chains.find(h=>h.id===d.chainIds[0])?.id??r.chains[0].id,l=[p,...r.chains.map(h=>h.id).filter(h=>h!==p)];return{...c,...d,chainIds:l}},name:r.storageKey,partialize:a=>({accounts:a.accounts.map(c=>he(c)),chainIds:a.chainIds}),storage:r.storage,version:5}))));let o=r.mode;const u={config:r,getMode(){return o},id:Gt(),setMode(a){return i?.(),o=a,i=a.setup({internal:u}),i},store:s},f=li(u);let i=o!==null?o.setup({internal:u}):()=>{};return{_internal:u,config:r,destroy(){i(),f._internal.destroy()},provider:f}}const ki=Object.freeze(Object.defineProperty({__proto__:null,create:wi,defaultConfig:re},Symbol.toStringTag,{value:"Module"}));export{ki as Porto,li as from};
