import{$ as Ue,C as ge,n as Ce,o as Fe,a0 as P,a1 as Ie,a2 as Se,a3 as Be,A as l,a4 as ke,a5 as Me,a6 as Ve,a7 as Te,a8 as je,e as I,a9 as Re,aa as ze,ab as $,ac as C,ad as x,ae as be,af as Ne,i as $e,b as A,Z as _e,ag as v,ah as He,ai as We,aj as Ze,B as p,ak as Ke,al as Pe,d as Xe,am as Je,an as Qe,ao as Ye,U as S,X as qe,ap as et,aq as tt,ar as at,as as nt,s as rt,at as it,au as st,av as ot}from"./index-BMhzyhP_.js";function St(e,t){if(e.length!==t.length)throw new Ue({expectedLength:e.length,givenLength:t.length});const a=[];for(let n=0;n<e.length;n++){const i=e[n],c=t[n];a.push(xe(i,c))}return ge(a)}function xe(e,t,a=!1){if(e==="address"){const r=t;if(!Ce(r))throw new Fe({address:r});return P(r.toLowerCase(),{size:a?32:null})}if(e==="string")return Ie(t);if(e==="bytes")return t;if(e==="bool")return P(Se(t),{size:a?32:1});const n=e.match(Be);if(n){const[r,s,o="256"]=n,d=Number.parseInt(o,10)/8;return l(t,{size:a?32:d,signed:s==="int"})}const i=e.match(ke);if(i){const[r,s]=i;if(Number.parseInt(s,10)!==(t.length-2)/2)throw new Me({expectedSize:Number.parseInt(s,10),givenSize:(t.length-2)/2});return P(t,{dir:"right",size:a?32:null})}const c=e.match(Ve);if(c&&Array.isArray(t)){const[r,s]=c,o=[];for(let d=0;d<t.length;d++)o.push(xe(s,t[d],!0));return o.length===0?"0x":ge(o)}throw new Te(e)}function ut(e){const{source:t}=e,a=new Map,n=new je(8192),i=new Map,c=({address:r,chainId:s})=>`${r}.${s}`;return{async consume({address:r,chainId:s,client:o}){const d=c({address:r,chainId:s}),m=this.get({address:r,chainId:s,client:o});this.increment({address:r,chainId:s});const f=await m;return await t.set({address:r,chainId:s},f),n.set(d,f),f},async increment({address:r,chainId:s}){const o=c({address:r,chainId:s}),d=a.get(o)??0;a.set(o,d+1)},async get({address:r,chainId:s,client:o}){const d=c({address:r,chainId:s});let m=i.get(d);return m||(m=(async()=>{try{const h=await t.get({address:r,chainId:s,client:o}),u=n.get(d)??0;return u>0&&h<=u?u+1:(n.delete(d),h)}finally{this.reset({address:r,chainId:s})}})(),i.set(d,m)),(a.get(d)??0)+await m},reset({address:r,chainId:s}){const o=c({address:r,chainId:s});a.delete(o),i.delete(o)}}}function H(e){const{address:t,data:a,signature:n,to:i="hex"}=e,c=ge([I([{type:"address"},{type:"bytes"},{type:"bytes"}],[t,a,n]),Re]);return i==="hex"?c:ze(c)}async function ct(e,t){const{account:a=e.account,chainId:n,nonce:i}=t;if(!a)throw new $({docsPath:"/docs/eip7702/prepareAuthorization"});const c=C(a),r=(()=>{if(t.executor)return t.executor==="self"?t.executor:C(t.executor)})(),s={address:t.contractAddress??t.address,chainId:n,nonce:i};return typeof s.chainId>"u"&&(s.chainId=e.chain?.id??await x(e,be,"getChainId")({})),typeof s.nonce>"u"&&(s.nonce=await x(e,Ne,"getTransactionCount")({address:c.address,blockTag:"pending"}),(r==="self"||r?.address&&$e(r.address,c.address))&&(s.nonce+=1)),s}const Bt=[{inputs:[{name:"preOpGas",type:"uint256"},{name:"paid",type:"uint256"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"targetSuccess",type:"bool"},{name:"targetResult",type:"bytes"}],name:"ExecutionResult",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"}],name:"ValidationResult",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"},{components:[{name:"aggregator",type:"address"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"stakeInfo",type:"tuple"}],name:"aggregatorInfo",type:"tuple"}],name:"ValidationResultWithAggregation",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[],name:"SIG_VALIDATION_FAILED",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"},{name:"sender",type:"address"},{name:"paymasterAndData",type:"bytes"}],name:"_validateSenderAndPaymaster",outputs:[],stateMutability:"view",type:"function"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"op",type:"tuple"},{name:"target",type:"address"},{name:"targetCallData",type:"bytes"}],name:"simulateHandleOp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"simulateValidation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];function Ge(e){const{authorization:t,factory:a,factoryData:n}=e;if(a==="0x7702"||a==="0x7702000000000000000000000000000000000000"){if(!t)return"0x7702000000000000000000000000000000000000";const i=t.address;return A([i,n??"0x"])}return a?A([a,n??"0x"]):"0x"}function ve(e){const{callGasLimit:t,callData:a,maxPriorityFeePerGas:n,maxFeePerGas:i,paymaster:c,paymasterData:r,paymasterPostOpGasLimit:s,paymasterVerificationGasLimit:o,sender:d,signature:m="0x",verificationGasLimit:f}=e,h=A([P(l(f||0n),{size:16}),P(l(t||0n),{size:16})]),u=Ge(e),O=A([P(l(n||0n),{size:16}),P(l(i||0n),{size:16})]),w=e.nonce??0n,g=c?A([c,P(l(o||0n),{size:16}),P(l(s||0n),{size:16}),r||"0x"]):"0x",G=e.preVerificationGas??0n;return{accountGasLimits:h,callData:a,initCode:u,gasFees:O,nonce:w,paymasterAndData:g,preVerificationGas:G,sender:d,signature:m}}const dt={PackedUserOperation:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"}]};function pt(e){const{chainId:t,entryPointAddress:a,userOperation:n}=e,i=ve(n);return{types:dt,primaryType:"PackedUserOperation",domain:{name:"ERC4337",version:"1",chainId:t,verifyingContract:a},message:i}}function kt(e){const{chainId:t,entryPointAddress:a,entryPointVersion:n}=e,i=e.userOperation,{authorization:c,callData:r="0x",callGasLimit:s,maxFeePerGas:o,maxPriorityFeePerGas:d,nonce:m,paymasterAndData:f="0x",preVerificationGas:h,sender:u,verificationGasLimit:O}=i;if(n==="0.8")return _e(pt({chainId:t,entryPointAddress:a,userOperation:i}));const w=(()=>{if(n==="0.6"){const g=i.initCode?.slice(0,42),G=i.initCode?.slice(42),E=Ge({authorization:c,factory:g,factoryData:G});return I([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[u,m,v(E),v(r),s,O,h,o,d,v(f)])}if(n==="0.7"){const g=ve(i);return I([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"}],[g.sender,g.nonce,v(g.initCode),v(g.callData),g.accountGasLimits,g.preVerificationGas,g.gasFees,v(g.paymasterAndData)])}throw new Error(`entryPointVersion "${n}" not supported.`)})();return v(I([{type:"bytes32"},{type:"address"},{type:"uint256"}],[v(w),a,BigInt(t)]))}async function Mt(e){const{extend:t,nonceKeyManager:a=ut({source:{get(){return Date.now()},set(){}}}),...n}=e;let i=!1;const c=await e.getAddress();return{...t,...n,address:c,async getFactoryArgs(){return"isDeployed"in this&&await this.isDeployed()?{factory:void 0,factoryData:void 0}:e.getFactoryArgs()},async getNonce(r){const s=r?.key??BigInt(await a.consume({address:c,chainId:e.client.chain.id,client:e.client}));return e.getNonce?await e.getNonce({...r,key:s}):await We(e.client,{abi:Ze(["function getNonce(address, uint192) pure returns (uint256)"]),address:e.entryPoint.address,functionName:"getNonce",args:[c,s]})},async isDeployed(){return i?!0:(i=!!await x(e.client,He,"getCode")({address:c}),i)},...e.sign?{async sign(r){const[{factory:s,factoryData:o},d]=await Promise.all([this.getFactoryArgs(),e.sign(r)]);return s&&o?H({address:s,data:o,signature:d}):d}}:{},async signMessage(r){const[{factory:s,factoryData:o},d]=await Promise.all([this.getFactoryArgs(),e.signMessage(r)]);return s&&o&&s!=="0x7702"?H({address:s,data:o,signature:d}):d},async signTypedData(r){const[{factory:s,factoryData:o},d]=await Promise.all([this.getFactoryArgs(),e.signTypedData(r)]);return s&&o&&s!=="0x7702"?H({address:s,data:o,signature:d}):d},type:"smart"}}class W extends p{constructor({cause:t}){super("Smart Account is not deployed.",{cause:t,metaMessages:["This could arise when:","- No `factory`/`factoryData` or `initCode` properties are provided for Smart Account deployment.","- An incorrect `sender` address is provided."],name:"AccountNotDeployedError"})}}Object.defineProperty(W,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa20/});class U extends p{constructor({cause:t,data:a,message:n}={}){const i=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${i?`with reason: ${i}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=a}}Object.defineProperty(U,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32521});Object.defineProperty(U,"message",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Z extends p{constructor({cause:t}){super("Failed to send funds to beneficiary.",{cause:t,name:"FailedToSendToBeneficiaryError"})}}Object.defineProperty(Z,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa91/});class K extends p{constructor({cause:t}){super("Gas value overflowed.",{cause:t,metaMessages:["This could arise when:","- one of the gas values exceeded 2**120 (uint120)"].filter(Boolean),name:"GasValuesOverflowError"})}}Object.defineProperty(K,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa94/});class X extends p{constructor({cause:t}){super("The `handleOps` function was called by the Bundler with a gas limit too low.",{cause:t,name:"HandleOpsOutOfGasError"})}}Object.defineProperty(X,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa95/});class J extends p{constructor({cause:t,factory:a,factoryData:n,initCode:i}){super("Failed to simulate deployment for Smart Account.",{cause:t,metaMessages:["This could arise when:","- Invalid `factory`/`factoryData` or `initCode` properties are present","- Smart Account deployment execution ran out of gas (low `verificationGasLimit` value)",`- Smart Account deployment execution reverted with an error
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,i&&`initCode: ${i}`].filter(Boolean),name:"InitCodeFailedError"})}}Object.defineProperty(J,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa13/});class Q extends p{constructor({cause:t,factory:a,factoryData:n,initCode:i}){super("Smart Account initialization implementation did not create an account.",{cause:t,metaMessages:["This could arise when:","- `factory`/`factoryData` or `initCode` properties are invalid",`- Smart Account initialization implementation is incorrect
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,i&&`initCode: ${i}`].filter(Boolean),name:"InitCodeMustCreateSenderError"})}}Object.defineProperty(Q,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa15/});class Y extends p{constructor({cause:t,factory:a,factoryData:n,initCode:i,sender:c}){super("Smart Account initialization implementation does not return the expected sender.",{cause:t,metaMessages:["This could arise when:",`Smart Account initialization implementation does not return a sender address
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,i&&`initCode: ${i}`,c&&`sender: ${c}`].filter(Boolean),name:"InitCodeMustReturnSenderError"})}}Object.defineProperty(Y,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa14/});class q extends p{constructor({cause:t}){super("Smart Account does not have sufficient funds to execute the User Operation.",{cause:t,metaMessages:["This could arise when:","- the Smart Account does not have sufficient funds to cover the required prefund, or","- a Paymaster was not provided"].filter(Boolean),name:"InsufficientPrefundError"})}}Object.defineProperty(q,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa21/});class ee extends p{constructor({cause:t}){super("Bundler attempted to call an invalid function on the EntryPoint.",{cause:t,name:"InternalCallOnlyError"})}}Object.defineProperty(ee,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa92/});class te extends p{constructor({cause:t}){super("Bundler used an invalid aggregator for handling aggregated User Operations.",{cause:t,name:"InvalidAggregatorError"})}}Object.defineProperty(te,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa96/});class ae extends p{constructor({cause:t,nonce:a}){super("Invalid Smart Account nonce used for User Operation.",{cause:t,metaMessages:[a&&`nonce: ${a}`].filter(Boolean),name:"InvalidAccountNonceError"})}}Object.defineProperty(ae,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa25/});class ne extends p{constructor({cause:t}){super("Bundler has not set a beneficiary address.",{cause:t,name:"InvalidBeneficiaryError"})}}Object.defineProperty(ne,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa90/});class B extends p{constructor({cause:t}){super("Invalid fields set on User Operation.",{cause:t,name:"InvalidFieldsError"})}}Object.defineProperty(B,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class re extends p{constructor({cause:t,paymasterAndData:a}){super("Paymaster properties provided are invalid.",{cause:t,metaMessages:["This could arise when:","- the `paymasterAndData` property is of an incorrect length\n",a&&`paymasterAndData: ${a}`].filter(Boolean),name:"InvalidPaymasterAndDataError"})}}Object.defineProperty(re,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa93/});class D extends p{constructor({cause:t}){super("Paymaster deposit for the User Operation is too low.",{cause:t,metaMessages:["This could arise when:","- the Paymaster has deposited less than the expected amount via the `deposit` function"].filter(Boolean),name:"PaymasterDepositTooLowError"})}}Object.defineProperty(D,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32508});Object.defineProperty(D,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa31/});class ie extends p{constructor({cause:t}){super("The `validatePaymasterUserOp` function on the Paymaster reverted.",{cause:t,name:"PaymasterFunctionRevertedError"})}}Object.defineProperty(ie,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa33/});class se extends p{constructor({cause:t}){super("The Paymaster contract has not been deployed.",{cause:t,name:"PaymasterNotDeployedError"})}}Object.defineProperty(se,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa30/});class k extends p{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterRateLimitError"})}}Object.defineProperty(k,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32504});class M extends p{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterStakeTooLowError"})}}Object.defineProperty(M,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32505});class oe extends p{constructor({cause:t}){super("Paymaster `postOp` function reverted.",{cause:t,name:"PaymasterPostOpFunctionRevertedError"})}}Object.defineProperty(oe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa50/});class ue extends p{constructor({cause:t,factory:a,factoryData:n,initCode:i}){super("Smart Account has already been deployed.",{cause:t,metaMessages:["Remove the following properties and try again:",a&&"`factory`",n&&"`factoryData`",i&&"`initCode`"].filter(Boolean),name:"SenderAlreadyConstructedError"})}}Object.defineProperty(ue,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa10/});class V extends p{constructor({cause:t}){super("UserOperation rejected because account signature check failed (or paymaster signature, if the paymaster uses its data as signature).",{cause:t,name:"SignatureCheckFailedError"})}}Object.defineProperty(V,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32507});class ce extends p{constructor({cause:t}){super("The `validateUserOp` function on the Smart Account reverted.",{cause:t,name:"SmartAccountFunctionRevertedError"})}}Object.defineProperty(ce,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa23/});class T extends p{constructor({cause:t}){super("UserOperation rejected because account specified unsupported signature aggregator.",{cause:t,name:"UnsupportedSignatureAggregatorError"})}}Object.defineProperty(T,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32506});class de extends p{constructor({cause:t}){super("User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validateUserOp` on the Smart Account are not satisfied"].filter(Boolean),name:"UserOperationExpiredError"})}}Object.defineProperty(de,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa22/});class pe extends p{constructor({cause:t}){super("Paymaster for User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validatePaymasterUserOp` on the Paymaster are not satisfied"].filter(Boolean),name:"UserOperationPaymasterExpiredError"})}}Object.defineProperty(pe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa32/});class ye extends p{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Smart Account"].filter(Boolean),name:"UserOperationSignatureError"})}}Object.defineProperty(ye,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa24/});class me extends p{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Paymaster"].filter(Boolean),name:"UserOperationPaymasterSignatureError"})}}Object.defineProperty(me,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa34/});class j extends p{constructor({cause:t}){super("User Operation rejected by EntryPoint's `simulateValidation` during account creation or validation.",{cause:t,name:"UserOperationRejectedByEntryPointError"})}}Object.defineProperty(j,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32500});class R extends p{constructor({cause:t}){super("User Operation rejected by Paymaster's `validatePaymasterUserOp`.",{cause:t,name:"UserOperationRejectedByPaymasterError"})}}Object.defineProperty(R,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32501});class z extends p{constructor({cause:t}){super("User Operation rejected with op code validation error.",{cause:t,name:"UserOperationRejectedByOpCodeError"})}}Object.defineProperty(z,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32502});class N extends p{constructor({cause:t}){super("UserOperation out of time-range: either wallet or paymaster returned a time-range, and it is already expired (or will expire soon).",{cause:t,name:"UserOperationOutOfTimeRangeError"})}}Object.defineProperty(N,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32503});class yt extends p{constructor({cause:t}){super(`An error occurred while executing user operation: ${t?.shortMessage}`,{cause:t,name:"UnknownBundlerError"})}}class le extends p{constructor({cause:t}){super("User Operation verification gas limit exceeded.",{cause:t,metaMessages:["This could arise when:","- the gas used for verification exceeded the `verificationGasLimit`"].filter(Boolean),name:"VerificationGasLimitExceededError"})}}Object.defineProperty(le,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa40/});class fe extends p{constructor({cause:t}){super("User Operation verification gas limit is too low.",{cause:t,metaMessages:["This could arise when:","- the `verificationGasLimit` is too low to verify the User Operation"].filter(Boolean),name:"VerificationGasLimitTooLowError"})}}Object.defineProperty(fe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa41/});class mt extends p{constructor(t,{callData:a,callGasLimit:n,docsPath:i,factory:c,factoryData:r,initCode:s,maxFeePerGas:o,maxPriorityFeePerGas:d,nonce:m,paymaster:f,paymasterAndData:h,paymasterData:u,paymasterPostOpGasLimit:O,paymasterVerificationGasLimit:w,preVerificationGas:g,sender:G,signature:E,verificationGasLimit:L}){const F=Ke({callData:a,callGasLimit:n,factory:c,factoryData:r,initCode:s,maxFeePerGas:typeof o<"u"&&`${Pe(o)} gwei`,maxPriorityFeePerGas:typeof d<"u"&&`${Pe(d)} gwei`,nonce:m,paymaster:f,paymasterAndData:h,paymasterData:u,paymasterPostOpGasLimit:O,paymasterVerificationGasLimit:w,preVerificationGas:g,sender:G,signature:E,verificationGasLimit:L});super(t.shortMessage,{cause:t,docsPath:i,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",F].filter(Boolean),name:"UserOperationExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}class lt extends p{constructor({hash:t}){super(`User Operation receipt with hash "${t}" could not be found. The User Operation may not have been processed yet.`,{name:"UserOperationReceiptNotFoundError"})}}class ft extends p{constructor({hash:t}){super(`User Operation with hash "${t}" could not be found.`,{name:"UserOperationNotFoundError"})}}class Oe extends p{constructor({hash:t}){super(`Timed out while waiting for User Operation with hash "${t}" to be confirmed.`,{name:"WaitForUserOperationReceiptTimeoutError"})}}const gt=[U,B,D,k,M,V,T,N,j,R,z];function bt(e,t){const a=(e.details||"").toLowerCase();if(W.message.test(a))return new W({cause:e});if(Z.message.test(a))return new Z({cause:e});if(K.message.test(a))return new K({cause:e});if(X.message.test(a))return new X({cause:e});if(J.message.test(a))return new J({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(Q.message.test(a))return new Q({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(Y.message.test(a))return new Y({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode,sender:t.sender});if(q.message.test(a))return new q({cause:e});if(ee.message.test(a))return new ee({cause:e});if(ae.message.test(a))return new ae({cause:e,nonce:t.nonce});if(te.message.test(a))return new te({cause:e});if(ne.message.test(a))return new ne({cause:e});if(re.message.test(a))return new re({cause:e});if(D.message.test(a))return new D({cause:e});if(ie.message.test(a))return new ie({cause:e});if(se.message.test(a))return new se({cause:e});if(oe.message.test(a))return new oe({cause:e});if(ce.message.test(a))return new ce({cause:e});if(ue.message.test(a))return new ue({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(de.message.test(a))return new de({cause:e});if(pe.message.test(a))return new pe({cause:e});if(me.message.test(a))return new me({cause:e});if(ye.message.test(a))return new ye({cause:e});if(le.message.test(a))return new le({cause:e});if(fe.message.test(a))return new fe({cause:e});const n=e.walk(i=>gt.some(c=>c.code===i.code));if(n){if(n.code===U.code)return new U({cause:e,data:n.data,message:n.details});if(n.code===B.code)return new B({cause:e});if(n.code===D.code)return new D({cause:e});if(n.code===k.code)return new k({cause:e});if(n.code===M.code)return new M({cause:e});if(n.code===V.code)return new V({cause:e});if(n.code===T.code)return new T({cause:e});if(n.code===N.code)return new N({cause:e});if(n.code===j.code)return new j({cause:e});if(n.code===R.code)return new R({cause:e});if(n.code===z.code)return new z({cause:e})}return new yt({cause:e})}function De(e,{calls:t,docsPath:a,...n}){const i=(()=>{const c=bt(e,n);if(t&&c instanceof U){const r=ht(c),s=t?.filter(o=>o.abi);if(r&&s.length>0)return wt({calls:s,revertData:r})}return c})();return new mt(i,{docsPath:a,...n})}function ht(e){let t;return e.walk(a=>{const n=a;if(typeof n.data=="string"||typeof n.data?.revertData=="string"||!(n instanceof p)&&typeof n.message=="string"){const i=(n.data?.revertData||n.data||n.message).match?.(/(0x[A-Za-z0-9]*)/);if(i)return t=i[1],!0}return!1}),t}function wt(e){const{calls:t,revertData:a}=e,{abi:n,functionName:i,args:c,to:r}=(()=>{const o=t?.filter(m=>!!m.abi);if(o.length===1)return o[0];const d=o.filter(m=>{try{return!!Xe({abi:m.abi,data:a})}catch{return!1}});return d.length===1?d[0]:{abi:[],functionName:o.reduce((m,f)=>`${m?`${m} | `:""}${f.functionName}`,""),args:void 0,to:void 0}})(),s=a==="0x"?new Je({functionName:i}):new Qe({abi:n,data:a,functionName:i});return new Ye(s,{abi:n,args:c,contractAddress:r,functionName:i})}function Pt(e){const t={};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),t}function _(e){const t={};return typeof e.callData<"u"&&(t.callData=e.callData),typeof e.callGasLimit<"u"&&(t.callGasLimit=l(e.callGasLimit)),typeof e.factory<"u"&&(t.factory=e.factory),typeof e.factoryData<"u"&&(t.factoryData=e.factoryData),typeof e.initCode<"u"&&(t.initCode=e.initCode),typeof e.maxFeePerGas<"u"&&(t.maxFeePerGas=l(e.maxFeePerGas)),typeof e.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=l(e.maxPriorityFeePerGas)),typeof e.nonce<"u"&&(t.nonce=l(e.nonce)),typeof e.paymaster<"u"&&(t.paymaster=e.paymaster),typeof e.paymasterAndData<"u"&&(t.paymasterAndData=e.paymasterAndData||"0x"),typeof e.paymasterData<"u"&&(t.paymasterData=e.paymasterData),typeof e.paymasterPostOpGasLimit<"u"&&(t.paymasterPostOpGasLimit=l(e.paymasterPostOpGasLimit)),typeof e.paymasterVerificationGasLimit<"u"&&(t.paymasterVerificationGasLimit=l(e.paymasterVerificationGasLimit)),typeof e.preVerificationGas<"u"&&(t.preVerificationGas=l(e.preVerificationGas)),typeof e.sender<"u"&&(t.sender=e.sender),typeof e.signature<"u"&&(t.signature=e.signature),typeof e.verificationGasLimit<"u"&&(t.verificationGasLimit=l(e.verificationGasLimit)),typeof e.authorization<"u"&&(t.eip7702Auth=Ot(e.authorization)),t}function Ot(e){return{address:e.address,chainId:l(e.chainId),nonce:l(e.nonce),r:e.r?l(BigInt(e.r),{size:32}):P("0x",{size:32}),s:e.s?l(BigInt(e.s),{size:32}):P("0x",{size:32}),yParity:e.yParity?l(e.yParity,{size:1}):P("0x",{size:32})}}async function xt(e,t){const{chainId:a,entryPointAddress:n,context:i,...c}=t,r=_(c),{paymasterPostOpGasLimit:s,paymasterVerificationGasLimit:o,...d}=await e.request({method:"pm_getPaymasterData",params:[{...r,callGasLimit:r.callGasLimit??"0x0",verificationGasLimit:r.verificationGasLimit??"0x0",preVerificationGas:r.preVerificationGas??"0x0"},n,l(a),i]});return{...d,...s&&{paymasterPostOpGasLimit:S(s)},...o&&{paymasterVerificationGasLimit:S(o)}}}async function Gt(e,t){const{chainId:a,entryPointAddress:n,context:i,...c}=t,r=_(c),{paymasterPostOpGasLimit:s,paymasterVerificationGasLimit:o,...d}=await e.request({method:"pm_getPaymasterStubData",params:[{...r,callGasLimit:r.callGasLimit??"0x0",verificationGasLimit:r.verificationGasLimit??"0x0",preVerificationGas:r.preVerificationGas??"0x0"},n,l(a),i]});return{...d,...s&&{paymasterPostOpGasLimit:S(s)},...o&&{paymasterVerificationGasLimit:S(o)}}}const vt=["factory","fees","gas","paymaster","nonce","signature","authorization"];async function he(e,t){const a=t,{account:n=e.account,parameters:i=vt,stateOverride:c}=a;if(!n)throw new $;const r=C(n),s=e,o=a.paymaster??s?.paymaster,d=typeof o=="string"?o:void 0,{getPaymasterStubData:m,getPaymasterData:f}=(()=>{if(o===!0)return{getPaymasterStubData:y=>x(s,Gt,"getPaymasterStubData")(y),getPaymasterData:y=>x(s,xt,"getPaymasterData")(y)};if(typeof o=="object"){const{getPaymasterStubData:y,getPaymasterData:b}=o;return{getPaymasterStubData:b&&y?y:b,getPaymasterData:b&&y?b:void 0}}return{getPaymasterStubData:void 0,getPaymasterData:void 0}})(),h=a.paymasterContext?a.paymasterContext:s?.paymasterContext;let u={...a,paymaster:d,sender:r.address};const[O,w,g,G,E]=await Promise.all([(async()=>a.calls?r.encodeCalls(a.calls.map(y=>{const b=y;return b.abi?{data:qe(b),to:b.to,value:b.value}:b})):a.callData)(),(async()=>{if(!i.includes("factory"))return;if(a.initCode)return{initCode:a.initCode};if(a.factory&&a.factoryData)return{factory:a.factory,factoryData:a.factoryData};const{factory:y,factoryData:b}=await r.getFactoryArgs();return r.entryPoint.version==="0.6"?{initCode:y&&b?A([y,b]):void 0}:{factory:y,factoryData:b}})(),(async()=>{if(i.includes("fees")){if(typeof a.maxFeePerGas=="bigint"&&typeof a.maxPriorityFeePerGas=="bigint")return u;if(s?.userOperation?.estimateFeesPerGas){const y=await s.userOperation.estimateFeesPerGas({account:r,bundlerClient:s,userOperation:u});return{...u,...y}}try{const y=s.client??e,b=await x(y,et,"estimateFeesPerGas")({chain:y.chain,type:"eip1559"});return{maxFeePerGas:typeof a.maxFeePerGas=="bigint"?a.maxFeePerGas:BigInt(2n*b.maxFeePerGas),maxPriorityFeePerGas:typeof a.maxPriorityFeePerGas=="bigint"?a.maxPriorityFeePerGas:BigInt(2n*b.maxPriorityFeePerGas)}}catch{return}}})(),(async()=>{if(i.includes("nonce"))return typeof a.nonce=="bigint"?a.nonce:r.getNonce()})(),(async()=>{if(i.includes("authorization")){if(typeof a.authorization=="object")return a.authorization;if(r.authorization&&!await r.isDeployed())return{...await ct(r.client,r.authorization),r:"0xfffffffffffffffffffffffffffffff000000000000000000000000000000000",s:"0x7aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",yParity:1}}})()]);typeof O<"u"&&(u.callData=O),typeof w<"u"&&(u={...u,...w}),typeof g<"u"&&(u={...u,...g}),typeof G<"u"&&(u.nonce=G),typeof E<"u"&&(u.authorization=E),i.includes("signature")&&(typeof a.signature<"u"?u.signature=a.signature:u.signature=await r.getStubSignature(u)),r.entryPoint.version==="0.6"&&!u.initCode&&(u.initCode="0x");let L;async function F(){return L||(e.chain?e.chain.id:(L=await x(e,be,"getChainId")({}),L))}let we=!1;if(i.includes("paymaster")&&m&&!d&&!a.paymasterAndData){const{isFinal:y=!1,sponsor:b,...Ae}=await m({chainId:await F(),entryPointAddress:r.entryPoint.address,context:h,...u});we=y,u={...u,...Ae}}if(r.entryPoint.version==="0.6"&&!u.paymasterAndData&&(u.paymasterAndData="0x"),i.includes("gas")){if(r.userOperation?.estimateGas){const y=await r.userOperation.estimateGas(u);u={...u,...y}}if(typeof u.callGasLimit>"u"||typeof u.preVerificationGas>"u"||typeof u.verificationGasLimit>"u"||u.paymaster&&typeof u.paymasterPostOpGasLimit>"u"||u.paymaster&&typeof u.paymasterVerificationGasLimit>"u"){const y=await x(s,Ee,"estimateUserOperationGas")({account:r,callGasLimit:0n,preVerificationGas:0n,verificationGasLimit:0n,stateOverride:c,...u.paymaster?{paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n}:{},...u});u={...u,callGasLimit:u.callGasLimit??y.callGasLimit,preVerificationGas:u.preVerificationGas??y.preVerificationGas,verificationGasLimit:u.verificationGasLimit??y.verificationGasLimit,paymasterPostOpGasLimit:u.paymasterPostOpGasLimit??y.paymasterPostOpGasLimit,paymasterVerificationGasLimit:u.paymasterVerificationGasLimit??y.paymasterVerificationGasLimit}}}if(i.includes("paymaster")&&f&&!d&&!a.paymasterAndData&&!we){const y=await f({chainId:await F(),entryPointAddress:r.entryPoint.address,context:h,...u});u={...u,...y}}return delete u.calls,delete u.parameters,delete u.paymasterContext,typeof u.paymaster!="string"&&delete u.paymaster,u}async function Ee(e,t){const{account:a=e.account,entryPointAddress:n,stateOverride:i}=t;if(!a&&!t.sender)throw new $;const c=a?C(a):void 0,r=tt(i),s=c?await x(e,he,"prepareUserOperation")({...t,parameters:["authorization","factory","nonce","paymaster","signature"]}):t;try{const o=[_(s),n??c?.entryPoint?.address],d=await e.request({method:"eth_estimateUserOperationGas",params:r?[...o,r]:[...o]});return Pt(d)}catch(o){const d=t.calls;throw De(o,{...s,...d?{calls:d}:{}})}}function Dt(e){return e.request({method:"eth_supportedEntryPoints"})}function Et(e){const t={...e};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.maxFeePerGas&&(t.maxFeePerGas=BigInt(e.maxFeePerGas)),e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=BigInt(e.maxPriorityFeePerGas)),e.nonce&&(t.nonce=BigInt(e.nonce)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),t}async function Lt(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationByHash",params:[t]},{dedupe:!0});if(!a)throw new ft({hash:t});const{blockHash:n,blockNumber:i,entryPoint:c,transactionHash:r,userOperation:s}=a;return{blockHash:n,blockNumber:BigInt(i),entryPoint:c,transactionHash:r,userOperation:Et(s)}}function At(e){const t={...e};return e.actualGasCost&&(t.actualGasCost=BigInt(e.actualGasCost)),e.actualGasUsed&&(t.actualGasUsed=BigInt(e.actualGasUsed)),e.logs&&(t.logs=e.logs.map(a=>at(a))),e.receipt&&(t.receipt=nt(t.receipt)),t}async function Le(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationReceipt",params:[t]},{dedupe:!0});if(!a)throw new lt({hash:t});return At(a)}async function Ut(e,t){const{account:a=e.account,entryPointAddress:n}=t;if(!a&&!t.sender)throw new $;const i=a?C(a):void 0,c=i?await x(e,he,"prepareUserOperation")(t):t,r=t.signature||await i?.signUserOperation?.(c),s=_({...c,signature:r});try{return await e.request({method:"eth_sendUserOperation",params:[s,n??i?.entryPoint?.address]},{retryCount:0})}catch(o){const d=t.calls;throw De(o,{...c,...d?{calls:d}:{},signature:r})}}function Ct(e,t){const{hash:a,pollingInterval:n=e.pollingInterval,retryCount:i,timeout:c=12e4}=t;let r=0;const s=rt(["waitForUserOperationReceipt",e.uid,a]);return new Promise((o,d)=>{const m=it(s,{resolve:o,reject:d},f=>{const h=w=>{O(),w(),m()},u=c?setTimeout(()=>h(()=>f.reject(new Oe({hash:a}))),c):void 0,O=st(async()=>{i&&r>=i&&(clearTimeout(u),h(()=>f.reject(new Oe({hash:a}))));try{const w=await x(e,Le,"getUserOperationReceipt")({hash:a});h(()=>f.resolve(w))}catch(w){const g=w;g.name!=="UserOperationReceiptNotFoundError"&&h(()=>f.reject(g))}finally{clearTimeout(u)}r++},{emitOnBegin:!0,interval:n});return O})})}function Ft(e){return{estimateUserOperationGas:t=>Ee(e,t),getChainId:()=>be(e),getSupportedEntryPoints:()=>Dt(e),getUserOperation:t=>Lt(e,t),getUserOperationReceipt:t=>Le(e,t),prepareUserOperation:t=>he(e,t),sendUserOperation:t=>Ut(e,t),waitForUserOperationReceipt:t=>Ct(e,t)}}function Vt(e){const{client:t,key:a="bundler",name:n="Bundler Client",paymaster:i,paymasterContext:c,transport:r,userOperation:s}=e;return Object.assign(ot({...e,chain:e.chain??t?.chain,key:a,name:n,transport:r,type:"bundlerClient"}),{client:t,paymaster:i,paymasterContext:c,userOperation:s}).extend(Ft)}const Tt="0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789";export{Bt as a,St as b,Vt as c,Tt as e,kt as g,Mt as t};
